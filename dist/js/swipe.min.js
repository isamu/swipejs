!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SwipeBook=t():e.SwipeBook=t()}(window,function(){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(a,s,function(t){return e[t]}.bind(null,s));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=7)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"increase",value:function(){return void 0===window.counter?window.counter=1:window.counter++,window.counter}},{key:"decrease",value:function(){return void 0===window.counter?window.counter=-1:window.counter--,window.counter}},{key:"getCounter",value:function(){return window.counter}}]),e}();t.default=s,e.exports=t.default},,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"getSize",value:function(){return window.swipe_screen_size?window.swipe_screen_size[1]:100}},{key:"setSize",value:function(e){window.swipe_screen_size=[e,e]}},{key:"setSizes",value:function(e,t){window.swipe_screen_size=[e,t]}},{key:"init",value:function(t,i){window.swipe_screen_width=t,window.swipe_screen_height=i,0==window.swipe_screen_width&&(window.swipe_screen_width=window.swipe_screen_height*$(window).width()/$(window).height()),0==window.swipe_screen_height&&(window.swipe_screen_height=window.swipe_screen_width*$(window).height()/$(window).width()),e.setOriginalSize(),e.setVirtualSize()}},{key:"setOriginalSize",value:function(){window.swipe_screen_window_width=$(window).width(),window.swipe_screen_window_height=$(window).height()}},{key:"setVirtualSize",value:function(){var e=window.swipe_screen_size||[100,100],t=window.swipe_screen_window_width*e[0]/(window.swipe_screen_window_height*e[1]),i=window.swipe_screen_width/window.swipe_screen_height;window.swipe_screen_ratio=1,t/i>=1?(window.swipe_screen_virtual_height=$(window).height()*e[1]/100,window.swipe_screen_virtual_width=window.swipe_screen_width/window.swipe_screen_height*window.swipe_screen_virtual_height):(window.swipe_screen_virtual_width=$(window).width()*e[0]/100,window.swipe_screen_virtual_height=window.swipe_screen_height/window.swipe_screen_width*window.swipe_screen_virtual_width),window.swipe_screen_ratio=window.swipe_screen_virtual_width/window.swipe_screen_width}},{key:"getRatio",value:function(){return window.swipe_screen_ratio}},{key:"swipewidth",value:function(){return window.swipe_screen_width}},{key:"swipeheight",value:function(){return window.swipe_screen_height}},{key:"virtualwidth",value:function(){return window.swipe_screen_virtual_width}},{key:"virtualheight",value:function(){return window.swipe_screen_virtual_height}},{key:"refresh",value:function(){e.setOriginalSize(),e.setVirtualSize()}},{key:"virtualX",value:function(e){return void 0==e?window.swipe_screen_virtual_width:window.swipe_screen_width?e/window.swipe_screen_width*window.swipe_screen_virtual_width:e}},{key:"virtualY",value:function(e){return void 0==e?window.swipe_screen_virtual_height:window.swipe_screen_height?e/window.swipe_screen_height*window.swipe_screen_virtual_height:e}}]),e}();t.default=s,e.exports=t.default},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.current_page=0,this.current_playing=null,this.media={}}return a(e,null,[{key:"getInstance",value:function(){return this.instance?this.instance:(this.instance=new e,this.instance)}}]),a(e,[{key:"page",value:function(e){return this.current_page=e,this}},{key:"push",value:function(e,t){return this.media[this.current_page]||(this.media[this.current_page]={}),this.media[this.current_page][e]=t,this}},{key:"setCurrent",value:function(){(e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)&&(this.current_page=e);if(this.current_playing!=this.current_page&&this.stop(),this.media[this.current_page]){var e=this.media[this.current_page];Object.keys(e).forEach(function(t){var i=e[t].media,a=e[t]&&e[t].videoDuration?e[t].videoDuration:i.duration,s=(e[t]&&e[t].videoStart?e[t].videoStart:0)+a;i.setCurrentTime(s)})}}},{key:"play",value:function(){(t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)&&(this.current_page=t);var e=this;if(this.current_playing!=this.current_page){if(this.stop(),this.media[this.current_page]){var t=this.media[this.current_page];Object.keys(t).forEach(function(i){var a=t[i],s=a.media,n=0;if(t[i]&&t[i].videoStart&&(n=t[i].videoStart,s.setCurrentTime(n)),a.canPlay?(s.currentTime=0,s.play(),s.addEventListener("ended",function(){e.current_playing=null})):(a.waitPlay=!0,e.media[e.current_page][i]=a),t[i]&&t[i].videoDuration){var o=t[i].videoDuration;setTimeout(function(){s.currentTime+1>Number(n)+Number(o)&&(s.stop(),e.current_playing=null)},1e3*o)}})}this.current_playing=this.current_page}return this}},{key:"playing",value:function(e){e<0&&(e=1+e);var t=this;if(this.media[this.current_page]){var i=this.media[this.current_page];Object.keys(i).forEach(function(a){var s=i[a],n=(s.media,i[a].dom),o=o=i[a]&&i[a].videoStart?i[a].videoStart:0,l=i[a]&&i[a].videoDuration?i[a].videoDuration:1,r=o+e*l;Math.abs(s.currentTime-r)>.05&&(n.currentTime=r,s.currentTime=r,t.media[t.current_page][a]=s)})}}},{key:"load",value:function(){var e=this;Object.keys(this.media).forEach(function(t){var i=e.media[t];Object.keys(i).forEach(function(a){var s=i[a],n=i[a].media;n.addEventListener("loadeddata",function(){e.media[t][a].waitPlay&&n.play(),s.canPlay=!0,e.media[t][a]=s},!1),n.load()})})}},{key:"media",value:function(){return this.media[this.current_page]}},{key:"stop",value:function(){if(null!==this.current_playing&&this.media[this.current_playing]){var e=this.media[this.current_playing];Object.keys(e).forEach(function(t){e[t].media.stop()})}this.current_playing=null}}]),e}();t.default=s,e.exports=t.default},,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=l(i(0)),n=l(i(4)),o=l(i(3));function l(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments[2],s=arguments[3];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$("head").prepend('<meta name="viewport" content="width = 640,user-scalable=no">'),this.first_touch=!1,this.data=t,this.title="Swipe",this.pages=[],this.base_css_id=a,this.back_css_id=s,this.media_player=n.default.getInstance(),this.loaded_callback=null,this.start_callback=null,this.finish_callback=null,"net.swipe.list"==t.type){var o=[];this.data.items.forEach(function(e,t){o.push('<li><a href="?file='+e.url+'">'+e.title+"</li>")}),$(a).html("<ul>"+o.join("")+"</ul>"),this.setScreen()}else $(a).html(""),this.step=i,e.setTemplateElements(this.getTemplateElements()),e.setMarkdown(this.getMarkdown()),this.templatePages=this.getTemplatePages(),this.setScreen(),this.paging=this.getPaging(),this.isLoaded={},this.isReady=!1,this.isFinished=!1,this.load(),this.step>this.pages.length&&(this.step=this.pages.length-1),this.pages.length>0&&this.domLoad()}return a(e,null,[{key:"setTemplateElements",value:function(e){this.templateElements=e}},{key:"getTemplateElements",value:function(){return this.templateElements}},{key:"setMarkdown",value:function(e){this.markdown=e}},{key:"getMarkdown",value:function(){return this.markdown}},{key:"pageInDuration",value:function(){return 400}}]),a(e,[{key:"setScreen",value:function(){this.dimension=this.data.dimension?this.data.dimension:[$(window).width(),$(window).height()],o.default.init(this.dimension[0],this.dimension[1]),this.bc=this.data.bc||"#a9a9a9",this.setSwipeCss()}},{key:"load",value:function(){var e=this;$.each(this.data.pages,function(t,i){var a;i.scene&&(a=e.templatePages[i.scene])&&(a=e.templatePages[i.scene]),i.template&&(a=e.templatePages[i.template])?a=e.templatePages[i.template]:e.templatePages["*"]&&(a=e.templatePages["*"]);var s=new SwipePage(i,a,t);e.pages.push(s)}),this.data.title&&(this.title=this.data.title,document.title=this.title)}},{key:"getTemplatePages",value:function(){return this.data.templates&&this.data.templates.pages?this.data.templates.pages:this.data.scenes?this.data.scenes:{}}},{key:"getTemplateElements",value:function(){return this.data.templates&&this.data.templates.elements?this.data.templates.elements:this.data.elements?this.data.elements:{}}},{key:"getMarkdown",value:function(){return this.data.markdown?this.data.markdown:{}}},{key:"getPaging",value:function(){return"leftToRight"==this.data.paging||"vertical"==this.data.paging||"rightToLeft"==this.data.paging?this.data.paging:"vertical"}},{key:"setSwipeCss",value:function(){var e=($(window).width()-o.default.virtualwidth())/2;$("#loading").css({height:o.default.virtualheight(),width:o.default.virtualwidth(),"z-index":100,"background-color":"#fff",overflow:"hidden",position:"absolute",left:e}),$(this.base_css_id).css({height:o.default.virtualheight(),width:o.default.virtualwidth(),overflow:"hidden",position:"absolute",left:e});var t=o.default.getSize();$(this.back_css_id).css({"background-color":this.bc,height:t+"vh",width:"100vw"})}},{key:"resize",value:function(){this.setScreen();for(var e=0;e<this.pages.length;e++)this.pages[e].resize(),this.justShow(e);this.setPageSize()}},{key:"setPageSize",value:function(){$("svg").css("overflow","visible"),$(".page").css({overflow:"hidden",height:o.default.virtualheight(),width:o.default.virtualwidth()})}},{key:"pageLoad",value:function(e){var t=this,i=this.pages[e];i.loadElement(),this.loadingBasePage>e?$(this.base_css_id).prepend(i.getHtml()):$(this.base_css_id).append(i.getHtml()),e==this.loadingBasePage?($("#page_"+e).css("opacity",1),i.active()):$("#page_"+e).css("opacity",0);var a=i.getBc();$("#page_"+e).css({"background-color":a}),$(".image_element_page_"+e).load(function(){$(this).attr("__default_width",$(this).width()),$(this).attr("__default_height",$(this).height()),$("#"+$(this).attr("__base_id")).attr("__default_width",$(this).width()),$("#"+$(this).attr("__base_id")).attr("__default_height",$(this).height()),t.initData($(this).attr("__page_id"),$(this).attr("__element_id")),t.counterDecrease()}),$(".element_page_"+e).each(function(e,i){t.initData($(i).attr("__page_id"),$(i).attr("__element_id")),t.counterDecrease()}),$(".video_element_"+e).each(function(e,i){var a=t.pages[$(i).attr("__page_id")].getElement($(i).attr("__element_id")),s=new MediaElement($(i).attr("id")+"-video",{flashName:"flashmediaelement.swf",loop:!0,success:function(e,t){a.setVideoElement=e}});this.media_player=n.default.getInstance();var o={media:s,canPlay:!1,currentTime:0,dom:$("#"+$(i).attr("id")+"-video")[0]};a.videoStart&&(o.videoStart=a.videoStart),a.videoDuration&&(o.videoDuration=a.videoDuration),this.media_player.page($(i).attr("__page_id")).push($(i).attr("id"),o),t.counterDecrease()}),this.checkAndUpdateNextPage()}},{key:"domLoad",value:function(){this.loadingPage=this.step,this.loadingBasePage=this.step,this.loadingPageOffset=0,this.pageLoad(this.loadingPage),$("#debug").css({position:"absolute","z-index":100}),this.setPageSize(),this.updateCss()}},{key:"updateCss",value:function(){$(".page").css({position:"absolute"}),$(".image_element").css({position:"absolute"}),$(".image_box").css({position:"absolute"}),$(".element_inner").css({position:"relative",height:"100%",width:"inherit"}),$(".video_element").css({position:"absolute"}),$(".text_element").css({position:"absolute"}),$(".svg_element").css({position:"absolute"})}},{key:"nextLoadPage",value:function(){return void 0===this.pages[this.loadingBasePage+Math.abs(this.loadingPageOffset)]&&void 0===this.pages[this.loadingBasePage-Math.abs(this.loadingPageOffset)]?null:(this.loadingPageOffset=-1*this.loadingPageOffset,this.loadingPageOffset>-1&&this.loadingPageOffset++,this.pages[this.loadingBasePage+this.loadingPageOffset]?(this.loadingPage=this.loadingBasePage+this.loadingPageOffset,this.loadingPage):this.nextLoadPage())}},{key:"counterDecrease",value:function(){console.log("decrease"),s.default.decrease(),$("#counter").html(s.default.getCounter()),this.checkAndUpdateNextPage()}},{key:"checkAndUpdateNextPage",value:function(){if(0==s.default.getCounter()){this.loadingPage==this.step&&($("#loading").remove(),this.show(this.step)),this.isLoaded[this.loadingPage]=!0;var e=this.nextLoadPage();null!==e?(console.log("load ",e),this.pageLoad(e),this.setPageSize(),this.updateCss()):this.loadFinish()}console.log(s.default.getCounter())}},{key:"loadFinish",value:function(){this.isReady=!0,this.loaded_callback&&this.loaded_callback()}},{key:"set_loaded_callback",value:function(e){this.loaded_callback=e}},{key:"set_start_callback",value:function(e){this.start_callback=e,console.log(this.start_callback)}},{key:"set_finish_callback",value:function(e){this.finish_callback=e}},{key:"initData",value:function(e,t){this.pages[e].initElement(t)}},{key:"next",value:function(){this.step===this.pages.length-1&&(this.isFinished=!0,this.finish_callback&&this.finish_callback(!0)),this.isLoaded[this.step+1]&&this.step<this.pages.length-1&&this.show(this.step+1)}},{key:"back",value:function(){this.isLoaded[this.step-1]&&this.step>0&&(this.show(this.step-1),this.isFinished&&(this.finish_callback&&this.finish_callback(!1),this.isFinished=!1))}},{key:"getStep",value:function(){return this.step}},{key:"getPages",value:function(){return this.pages}},{key:"getPageSize",value:function(){return this.pages.length}},{key:"justShow",value:function(e){this.pages[e].justShow()}},{key:"nextAnimate",value:function(e){var t=this.pages[e].getPlayStyle();"auto"==t?this.pages[e].delayShow():"scroll"==t?this.pages[e].show():"always"==t?this.pages[e].delayShow():"pause"==t&&this.pages[e].finShow()}},{key:"prevAnimate",value:function(e){var t=this.pages[e].getPlayStyle();"auto"==t?this.pages[e].finShow():"scroll"==t?this.pages[e].show():"always"==t?this.pages[e].delayShow():"pause"==t&&this.pages[e].finShow()}},{key:"show",value:function(t){var i=this.step,a=t>=i?"forward":"back",s=t==i;s||(this.pages[i].inactive(),this.pages[t].active()),!this.first_touch&&this.isReady&&(this.media_player.load(),this.first_touch=!0,this.start_callback&&this.start_callback());this.pages[Math.max(i,t)].getTransition();var n=this.pages[i].getTransition(),o=this.pages[t].getTransition(),l=this;"forward"==a?(this.nextAnimate(t),"fadeIn"==o?$("#page_"+t).animate({opacity:1},{duration:e.pageInDuration()}):"replace"==o?$("#page_"+t).css({opacity:1}):"scroll"==o?this.pageSlide("in",t):"slide"==o?this.pageSlideDown("in",t,s):console.log("wrong transition in step "+String(t)),s||("fadeIn"==n?$("#page_"+i).animate({opacity:0},{duration:e.pageInDuration()}):"replace"==n?setTimeout(function(){$("#page_"+i).css({opacity:0})},e.pageInDuration()):"scroll"==n&&this.pageSlide("out",i))):(console.log("back"),this.prevAnimate(t),"fadeIn"==o?($("#page_"+t).css({opacity:0}),$("#page_"+t).animate({opacity:1},{duration:e.pageInDuration()})):"replace"==o?("replace"==n?setTimeout(function(){$("#page_"+t).css({opacity:1})},e.pageInDuration()):$("#page_"+t).css({opacity:1}),setTimeout(function(){l.pages[t].doLoopProcess()},e.pageInDuration())):"scroll"==o&&"scroll"==n?($("#page_"+t).css({opacity:1}),this.pageSlide("out_back",t)):($("#page_"+t).css({top:0,left:0}),$("#page_"+t).css({opacity:1}),setTimeout(function(){l.pages[t].doLoopProcess()},e.pageInDuration())),"fadeIn"==n?($("#page_"+i).css({opacity:1}),$("#page_"+i).animate({opacity:0},{duration:e.pageInDuration()})):"replace"==n?(this.pages[i].back(),setTimeout(function(){$("#page_"+i).css({opacity:0})},e.pageInDuration())):"scroll"==n?this.pageSlide("in_back",i):"slide"==n&&this.pageSlideDown("back",i,s)),s||("auto"==this.pages[t].getPlayStyle()&&(console.log("AUTO NEXT"),this.media_player.play(t)),"scroll"==this.pages[t].getPlayStyle()&&(console.log("scroll NEXT"),this.media_player.play(t))),s&&"auto"==this.pages[i].getPlayStyle()&&this.media_player.play(i),this.step=t,location.hash=t}},{key:"pageSlide",value:function(t,i){if(console.log("pageSlide"),"in"==t)$("#page_"+i).css("opacity",1),"vertical"==this.paging?($("#page_"+i).css("top",o.default.virtualheight()),$("#page_"+i).animate({top:0},{duration:e.pageInDuration()})):"leftToRight"==this.paging?($("#page_"+i).css("left",o.default.virtualwidth()),$("#page_"+i).animate({left:0},{duration:e.pageInDuration()})):"rightToLeft"==this.paging&&($("#page_"+i).css("left",-o.default.virtualwidth()),$("#page_"+i).animate({left:0},{duration:e.pageInDuration()}));else if("out"==t)"vertical"==this.paging?($("#page_"+i).css("top",0),$("#page_"+i).css("opacity",1),$("#page_"+i).animate({top:-o.default.virtualheight()},{duration:e.pageInDuration()})):"leftToRight"==this.paging?($("#page_"+i).css("left",0),$("#page_"+i).css("opacity",1),$("#page_"+i).animate({left:-o.default.virtualwidth()},{duration:e.pageInDuration()})):"rightToLeft"==this.paging&&($("#page_"+i).css("left",0),$("#page_"+i).css("opacity",1),$("#page_"+i).animate({left:o.default.virtualwidth()},{duration:e.pageInDuration()})),setTimeout(function(){$("#page_"+i).css("opacity",0)},e.pageInDuration());else if("in_back"==t){var a={duration:e.pageInDuration(),complete:function(){$("#page_"+i).css({opacity:0})}};"vertical"==this.paging?($("#page_"+i).css("top",0),$("#page_"+i).animate({top:o.default.virtualheight()},a)):"leftToRight"==this.paging?($("#page_"+i).css("left",0),$("#page_"+i).css("opacity",1),$("#page_"+i).animate({left:o.default.virtualwidth(),opacity:1},a)):"rightToLeft"==this.paging&&($("#page_"+i).css("left",0),$("#page_"+i).css("opacity",1),$("#page_"+i).animate({left:-o.default.virtualwidth(),opacity:1},a)),setTimeout(function(){$("#page_"+i).css("opacity",0)},e.pageInDuration())}else if("out_back"==t){$("#page_"+i).css("opacity",1);var s={duration:e.pageInDuration()};"vertical"==this.paging?($("#page_"+i).css("top",-o.default.virtualheight()),$("#page_"+i).animate({top:0},s)):"leftToRight"==this.paging?($("#page_"+i).css("left",-o.default.virtualwidth()),$("#page_"+i).css("opacity",1),$("#page_"+i).animate({left:0,opacity:1},s)):"rightToLeft"==this.paging&&($("#page_"+i).css("left",o.default.virtualwidth()),$("#page_"+i).css("opacity",1),$("#page_"+i).animate({left:0,opacity:1},s))}}},{key:"pageSlideDown",value:function(t,i,a){if(console.log("pageSlideDown"),"in"==t){$("#page_"+i).css({opacity:0});var s=this.paging;setTimeout(function(){$("#page_"+i).css({opacity:1}),"vertical"==s?($("#page_"+i).css("height",0),$("#page_"+i).animate({height:o.default.virtualheight()},{duration:e.pageInDuration()}),console.log("in vertical slide")):"leftToRight"==s&&($("#page_"+i).css({left:0,width:0}),$("#page_"+i).animate({width:o.default.virtualwidth()},{duration:e.pageInDuration()}))},a?300:0)}else if("back"==t){e.pageInDuration();"vertical"==this.paging?($("#page_"+i).css("height",o.default.virtualheight()),setTimeout(function(){$("#page_"+i).animate({height:0},{duration:e.pageInDuration()})},a?200:0),console.log("in_back vertical slide")):"leftToRight"==this.paging?($("#page_"+i).css({left:0,width:o.default.virtualwidth()}),$("#page_"+i).animate({width:0},{duration:e.pageInDuration()})):this.paging,setTimeout(function(){$("#page_"+i).css("opacity",0)},e.pageInDuration())}}},{key:"pageSlideDown2",value:function(e,t,i){console.log("pageSlideDown"),"in"==e?($("#page_"+t).css({opacity:1}),"vertical"==this.paging?($("#page_"+t).css({top:0,height:o.default.virtualheight()*i}),console.log("in vertical slide")):"leftToRight"==this.paging?$("#page_"+t).css({left:0,width:o.default.virtualwidth()*i}):this.paging):"back"==e&&("vertical"==this.paging?($("#page_"+t).css({top:0,height:o.default.virtualheight()*(1+i)}),console.log("in_back vertical slide")):"leftToRight"==this.paging?$("#page_"+t).css({left:0,width:o.default.virtualwidth()*(1+i)}):this.paging)}},{key:"view",value:function(e){var t=this.step+(e>0?1:-1),i=this.step,a=t>=i?"forward":"back";if(t<0||t>=this.pages.length)return 0;"forward"==a&&"scroll"==this.pages[t].getPlayStyle()&&this.media_player.playing(e),"back"==a&&"scroll"==this.pages[i].getPlayStyle()&&this.media_player.playing(e),"pause"==this.pages[t].getPlayStyle()&&this.pages[t].pause();this.pages[Math.max(i,t)].getTransition();var s=this.pages[i].getTransition(),n=this.pages[t].getTransition();"forward"==a?"fadeIn"==n?$("#page_"+t).css({opacity:e}):"replace"==n?$("#page_"+t).css({opacity:1}):"scroll"==n?this.pageSlide2("in",t,e):"slide"==n?this.pageSlideDown2("in",t,e):console.log("wrong transition in step "+String(t)):(console.log("back"),"fadeIn"==n&&$("#page_"+t).css({opacity:Math.abs(e)}),"fadeIn"==s?$("#page_"+i).css({opacity:1-Math.abs(e)}):"scroll"==s?this.pageSlide2("in_back",i,e):"slide"==s&&this.pageSlideDown2("back",i,e))}},{key:"nextStart",value:function(e){if(!this.first_touch&&this.isReady&&(this.media_player.load(),this.start_callback&&this.start_callback(),this.first_touch=!0),this.step+1>=this.pages.length)return this.isFinished=!0,this.finish_callback&&this.finish_callback(!0),0;var t=this.pages[this.step+1].getPlayStyle();this.pages[this.step+1].prevShow(),"scroll"==t&&($("#page_"+String(this.step+1)).css("opacity",1),this.pages[this.step+1].animateShow()),"auto"==this.pages[this.step+1].getPlayStyle()&&this.media_player.play(this.step+1),"scroll"==this.pages[this.step+1].getPlayStyle()&&this.media_player.play(this.step+1),"always"==this.pages[this.step+1].getPlayStyle()&&this.media_player.play(this.step+1),"pause"==this.pages[this.step+1].getPlayStyle()&&this.media_player.play(this.step+1)}},{key:"nextHide",value:function(){var e=this.step+1;if(e>=this.pages.length)return 0;$("#page_"+e).css("opacity",0),this.pages[e].finShow()}},{key:"nextEnd",value:function(){var e=this.step+1;if(e>=this.pages.length)return 0;$("#page_"+this.step).css("opacity",0),$("#page_"+e).css("top",0),$("#page_"+e).css("left",0),$("#page_"+e).css("opacity",1),$("#page_"+e).css("width",o.default.virtualwidth()),$("#page_"+e).css("height",o.default.virtualheight());var t=this.pages[e].getPlayStyle();"scroll"==t?this.pages[e].finShow():"auto"!=t&&"always"!=t||this.pages[e].show(),this.step=e,location.hash=e}},{key:"prevStart",value:function(e){if(console.log("prevStart"),this.step<=0)return 0;this.isFinished&&(this.finish_callback&&this.finish_callback(!1),this.isFinished=!1);var t=this.pages[this.step-1].getPlayStyle(),i=this.pages[this.step].getPlayStyle();$("#page_"+String(this.step-1)).css("opacity",1),"always"==t?(this.pages[this.step-1].prevShow(),this.media_player.play(this.step-1)):(this.pages[this.step-1].finShow(),this.media_player.setCurrent(this.step-1)),"scroll"==i&&(this.pages[this.step].finShow(),this.pages[this.step].animateShowBack())}},{key:"prevHide",value:function(){var e=this.step-1;if(e<0)return 0;$("#page_"+e).css("opacity",0),this.pages[e].finShow()}},{key:"prevEnd",value:function(){var e=this.step-1;if(e<0)return 0;$("#page_"+this.step).css("opacity",0),$("#page_"+e).css("opacity",1),$("#page_"+e).css("top",0),$("#page_"+e).css("left",0),"always"==this.pages[e].getPlayStyle()?this.pages[e].show():this.pages[e].finShow(),this.step=e,location.hash=e}},{key:"pageSlide2",value:function(t,i,a){"in"==t?($("#page_"+i).css("opacity",1),"vertical"==this.paging?$("#page_"+i).css("top",o.default.virtualheight()*(1-a)):"leftToRight"==this.paging?$("#page_"+i).css("left",o.default.virtualwidth()*(1-a)):"rightToLeft"==this.paging&&($("#page_"+i).css("left",-o.default.virtualwidth()),$("#page_"+i).animate({left:0},{duration:e.pageInDuration()}))):"in_back"==t&&("vertical"==this.paging?$("#page_"+i).css("top",-o.default.virtualheight()*a):"leftToRight"==this.paging?($("#page_"+i).css("left",-o.default.virtualheight()*a),$("#page_"+i).css("opacity",1)):"rightToLeft"==this.paging&&($("#page_"+i).css("left",o.default.virtualheight()*a),$("#page_"+i).css("opacity",1)))}}]),e}();t.default=r,e.exports=t.default}])});
!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.SwipeCounter=n():e.SwipeCounter=n()}(window,function(){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();var o=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"increase",value:function(){return void 0===window.counter?window.counter=1:window.counter++,window.counter}},{key:"decrease",value:function(){return void 0===window.counter?window.counter=-1:window.counter--,window.counter}},{key:"getCounter",value:function(){return window.counter}}]),e}();n.default=o,e.exports=n.default}])});
!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.SwipeElement=i():t.SwipeElement=i()}(window,function(){return function(t){var i={};function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)e.d(s,n,function(i){return t[i]}.bind(null,n));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=2)}([function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}();var n=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t)}return s(t,null,[{key:"increase",value:function(){return void 0===window.counter?window.counter=1:window.counter++,window.counter}},{key:"decrease",value:function(){return void 0===window.counter?window.counter=-1:window.counter--,window.counter}},{key:"getCounter",value:function(){return window.counter}}]),t}();i.default=n,t.exports=i.default},,function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(e(0));var a=function(){function t(i,e,s,n,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var r="element-"+e+"-"+s;this.info=this.mergeTemplate(i),this.to_info=this.info.to?SwipeUtil.merge(this.info,this.info.to):null,this.css_id=r,this.page_id=e,this.element_id=s,this.play_style=n,this.duration=o,this.parent=a,this.isActive=!1,this.videoStart=0,this.videoDuration=null,this.isRepeat=Boolean(i.repeat),this.x=0,this.y=0,this.angle=this.info.rotate?this.getAngle(this.info.rotate):0,this.to_angle=this.to_info&&this.to_info.rotate?this.getAngle(this.to_info.rotate):0,this.scale=this.getScale(this.info),this.to_scale=this.to_info?this.getScale(this.to_info):[1,1],this.no_size=!1,this.transition_timing=null,this.loop_timing=null,this.elements=[];var h=this;if(this.bc=null,this.info.bc&&(this.bc=this.info.bc),this.info.elements&&!this.isPathRoot()){(Array.isArray(this.info.elements)?this.info.elements:[this.info.elements]).forEach(function(i,a){var r=s+"-"+a;h.elements.push(new t(i,e,r,n,o,h))})}}return n(t,[{key:"mergeTemplate",value:function(t){var i;(t.element||t.template)&&((i=SwipeBook.getTemplateElements()[t.element||t.template])&&(t=SwipeParser.inheritProperties(t,i)));return t}},{key:"insertBr",value:function(t){return t.replace(/\n/g,"<br/>").replace(/\s/g,"&nbsp;")}},{key:"parseText",value:function(t){return"string"==typeof t?t:"object"==(void 0===t?"undefined":s(t))?t.ref?SwipeParser.localizedStringForKey(t.ref):SwipeParser.localizedString(t,"ja"):""}},{key:"parseMarkdown",value:function(t){var i=SwipeBook.getMarkdown();return new SwipeMarkdown(i).parse(t,this.css_id)}},{key:"getElement",value:function(t){if(void 0!==t){var i=t.split("-");return 1==i.length?this.elements[t]:this.elements[i.shift()].getElement(i.join("-"))}return this}},{key:"initData",value:function(t){if(void 0===t)(this.isDiv()||this.isMarkdown())&&(this.parent||$("#"+this.css_id).css("position","absolute")),this.isPath()&&(this.snap=Snap("#"+this.css_id+"_svg"),this.path=this.snap.path()),this.isVideo()&&this.initVideo(),this.setSize(),this.setPosition(),this.setOption(),$("#"+this.css_id).attr("__x",this.x),$("#"+this.css_id).attr("__y",this.y),$("#"+this.css_id).attr("__w",this.w),$("#"+this.css_id).attr("__h",this.h),this.bc&&$("#"+this.css_id).css({"background-color":this.bc}),this.isImage()&&this.setImageCss(),this.initAllData(),this.isPath()&&(this.prevPath=this.parsePath(),this.finPath=this.parseFinPath()),this.setPrevPos(),this.markdown_position();else{var i=t.split("-");1==i.length?this.elements[t].initData():this.elements[i.shift()].initData(i.join("-"))}}},{key:"setImageCss",value:function(){this.w/this.h<$("#"+this.css_id+"_image").attr("__default_width")/$("#"+this.css_id+"_image").attr("__default_height")?($("#"+this.css_id+"_image").css("height","100%"),$("#"+this.css_id+"_image").css("width","auto")):($("#"+this.css_id+"_image").css("height","auth"),$("#"+this.css_id+"_image").css("width","100%")),$("#"+this.css_id+"_image").css("top","50%"),$("#"+this.css_id+"_image").css("left","50%"),$("#"+this.css_id+"_image").css("transform","translate(-50%,-50%)"),$("#"+this.css_id+"_image").css("-webkit-transform","translateY(-50%) translateX(-50%)"),$("#"+this.css_id+"_image").css("-moz-transform","translate(-50%,-50%)")}},{key:"initAllData",value:function(){this.initPosData=[Number(this.x),Number(this.y),Number(this.w),Number(this.h),Number(this.angle),Number(this.opacity),this.scale],this.isText(),this.originalPrevPos=this.updatePosition(this.initPosData,this.info),this.prevPos=this.getScreenPosition(this.originalPrevPos),this.originalFinPos=this.getOriginalFinPos(),this.finPos=this.getScreenPosition(this.originalFinPos),this.isText()&&(this.prevText=this.textLayout(this.info,this.originalPrevPos),this.finText=this.textLayout(this.info,this.originalFinPos))}},{key:"getOriginalFinPos",value:function(){if(this.hasTo()){var t=this.initPosData;return this.info.to.pos&&this.info.to.pos.match(/^M/),this.updatePosition(t,this.to_info)}return this.originalPrevPos}},{key:"path2pos",value:function(t){var i=[0,0],e=t.match(/(\w[0-9\s\.,\-]+)/g);return $.each(e,function(t,e){var s=e.slice(0,1),n=e.slice(1).split(",");"M"==s&&(i=[Number(n[0]),Number(n[1])]),"l"==s&&(i=[Number(i[0])+Number(n[0]),Number(i[1])+Number(n[1])])}),i}},{key:"setOption",value:function(){this.opacity=1,null!=this.info.opacity&&(this.opacity=this.info.opacity),this.info.clip&&!0===this.info.clip&&$("#"+this.css_id).css("overflow","hidden"),this.info._pathRoot&&$("#"+this.css_id).css("overflow","hidden")}},{key:"initVideo",value:function(){this.videoStart=0,this.info.videoStart&&(this.videoStart=this.info.videoStart),this.videoDuration=1,this.info.videoDuration&&(this.videoDuration=this.info.videoDuration)}},{key:"setSize",value:function(){this.info.size?(this.w=this.info.size[0],this.h=this.info.size[1]):(this.info.w?this.w=SwipeParser.parseSize(this.info.w,this.getWidth(),this.getWidth()):this.isImage()?this.w=$("#"+this.css_id).attr("__default_width"):(this.w=this.parentWidth(),this.no_size=!0),this.info.h?this.h=SwipeParser.parseSize(this.info.h,this.getHeight(),this.getHeight()):this.isImage()?this.h=$("#"+this.css_id).attr("__default_height"):(this.h=this.parentHeight(),this.no_size=!0))}},{key:"setPosition",value:function(){this.info.pos?(this.x=this.info.pos[0],this.y=this.info.pos[1]):("right"==this.info.x?this.x=this.parentWidth()-this.w:"left"==this.info.x?this.x=0:"center"==this.info.x?this.x=(this.parentWidth()-this.w)/2:this.info.x&&(this.x=SwipeParser.parseSize(this.info.x,this.parentWidth(),0)),"bottom"==this.info.y?this.y=this.parentHeight()-this.h:"top"==this.info.y?this.y=0:"center"==this.info.y?this.y=(this.parentHeight()-this.h)/2:this.info.y&&(this.y=SwipeParser.parseSize(this.info.y,this.parentHeight(),0)))}},{key:"getAngle",value:function(t){return SwipeParser.is("Array",t)?t[2]:t||0}},{key:"getWidth",value:function(){return this.w?this.w:this.parent?this.parent.getWidth():SwipeScreen.swipewidth()}},{key:"getHeight",value:function(){return this.h?this.h:this.parent?this.parent.getHeight():SwipeScreen.swipeheight()}},{key:"parentWidth",value:function(){var t;return this.parent&&(t=this.parent.getWidth()),t||SwipeScreen.swipewidth()}},{key:"parentHeight",value:function(){var t;return this.parent&&(t=this.parent.getHeight()),t||SwipeScreen.swipeheight()}},{key:"setVideo",value:function(t){$("#"+this.css_id+"-video").css(this.convCssPos(t,!0))}},{key:"getSpritePos",value:function(){var t=this.prevPos[2],i=this.prevPos[3];return[-t*this.info.slot[0],-i*this.info.slot[1],t*this.info.slice[0],i*this.info.slice[1]]}},{key:"getSpriteCss",value:function(t){return{left:t[0],top:t[1],width:t[2],height:t[3]}}},{key:"setSpritePos",value:function(t){$("#"+this.css_id+"_sprite").css(this.getSpriteCss(t))}},{key:"prevShow",value:function(){this.elements&&this.elements.forEach(function(t,i){t.prevShow()}),this.setPrevPos()}},{key:"setPrevPos",value:function(){var t=this;if($("#"+this.css_id).css(this.convCssPos(this.prevPos)),this.isVideo()&&this.setVideo(this.prevPos),this.isSprite()){var i=this.getSpritePos();this.setSpritePos(i)}this.isText()&&($("#"+this.css_id+"-body").css(this.prevText),this.info.textVertical&&$("#"+this.css_id).css(this.textVertical())),this.isPath()&&(this.path.attr(this.prevPath.path),this.path.attr({fill:this.prevPath.fill})),this.isMarkdown()&&this.md_css.forEach(function(i,e){$("#"+t.css_id+"-"+e).css(i)})}},{key:"textLayout",value:function(t,i){var e="center",s="center";if(t.textAlign)switch(t.textAlign){case"left":s="left";break;case"right":s="right";break;case"top":e="top";break;case"bottom":e="bottom"}var n=SwipeParser.parseFontName(t,!1),o=function(t,i){var e=20/480*SwipeScreen.swipeheight(),s=SwipeParser.parseFontSize(t,SwipeScreen.swipeheight(),e,!1);return Math.round(s*Math.abs(i[1]))}(t,i[6]),a=o,r=i[3],h="bottom"==e?r-a:0,l={top:String(SwipeScreen.virtualY(h))+"px",position:"relative","font-size":String(Math.round(o))+"px","line-height":String(Math.round(Math.abs(1.5*o)))+"px","font-family":String(n),textAlign:s,color:this.conv_rgba2rgb(SwipeParser.parseColor(t,"#000"))};return"center"==e&&(l=SwipeUtil.merge(l,{width:"inherit",height:String(SwipeScreen.virtualY(r))+"px",display:"table-cell","vertical-align":"middle"})),l}},{key:"textVertical",value:function(){return{"-webkit-writing-mode":"vertical-rl","-ms-writing-mode":"tb-rl","writing-mode":"vertical-rl"}}},{key:"conv_rgba2rgb",value:function(t){var i;return(i=t.match(/^(#\w{6})(\w{2})$/))?i[1]:t}},{key:"transformPath",value:function(t,i){var e=[],s=[SwipeScreen.getRatio(),SwipeScreen.getRatio()],n=[],o=Math.abs(i[0]),a=Math.abs(i[1]);n=[s[0]*o,s[1]*a];var r=0,h=0;return!i||1==o&&1==a||(r=(1-o)*this.prevPos[2]/2,h=(1-a)*this.prevPos[3]/2,e.push("translate("+String(r)+","+String(h)+")")),e.push("scale("+n.join(",")+")"),e.join(" ")}},{key:"parsePath",value:function(){var t=this.info.lineWidth?this.info.lineWidth:1,i=this.info.strokeColor?this.info.strokeColor:"black",e=this.info.fillColor?"#0000"==this.info.fillColor?"none":this.info.fillColor:"none";return{path:{d:this.info.path,transform:this.transformPath(this.info,this.scale),stroke:this.conv_rgba2rgb(i),strokeWidth:t},fill:this.conv_rgba2rgb(e)}}},{key:"parseFinPath",value:function(){if(!this.hasTo())return this.prevPath;var t=SwipeUtil.merge(this.info,this.info.to),i=t.lineWidth?t.lineWidth:1,e=t.strokeColor?t.strokeColor:"black",s=t.fillColor?"#0000"==t.fillColor?"none":t.fillColor:"none";t.rotate&&[t.rotate[2],this.prevPos[2]/2,this.prevPos[3]/2].join(",");return{path:{d:t.path,transform:this.transformPath(t,this.getScale(t)),stroke:this.conv_rgba2rgb(e),strokeWidth:i},fill:this.conv_rgba2rgb(s)}}},{key:"animatePrevPos",value:function(){if(this.hasTo()){var t=this;if($("#"+t.css_id).animate(t.convCssPos(t.prevPos),{duration:this.duration,progress:function(i,e){t.animateTransform(1-e),t.isPath()&&$("#"+t.css_id).css("overflow","visible")}}),this.isText()&&(t.finText["font-family"]&&delete t.finText["font-family"],$("#"+this.css_id+"-body").animate(this.prevText,{duration:this.duration})),this.isPath()){var i=SwipeParser.clone(this.prevPath.path);delete i.stroke,this.path.animate(i,this.duration),this.prevPath.fill!=this.finPath.fill&&this.path.attr({fill:this.prevPath.fill})}}}},{key:"markdown_position",value:function(){if(this.isMarkdown()){var t=($("#"+this.css_id).height()-$("#md_"+this.css_id).height())/2;$("#md_"+this.css_id).css({top:t,position:"absolute"})}}},{key:"setFinPos",value:function(){if($("#"+this.css_id).css(this.convCssPos(this.finPos)),this.isVideo()&&this.setVideo(this.finPos),this.isText()){var t=this.textLayout(this.info,this.originalFinPos);$("#"+this.css_id+"-body").css(t),this.info.textVertical&&$("#"+this.css_id).css(this.textVertical())}this.isPath()&&(this.path.attr(this.finPath.path),this.path.attr({fill:this.finPath.fill}))}},{key:"animateTransform",value:function(t){var i=[];if(this.angle!=this.to_angle){var e=this.angle*(1-t)+this.to_angle*t;i.push("rotate("+e+"deg)")}else i.push("rotate("+this.angle+"deg)");if(!this.isPath()&&!this.isText())if(this.scale!=this.to_scale){var s=[this.scale[0]*(1-t)+this.to_scale[0]*t,this.scale[1]*(1-t)+this.to_scale[1]*t];i.push("scale("+s[0]+", "+s[1]+")")}else i.push("scale("+this.scale[0]+", "+this.scale[1]+")");$("#"+this.css_id).css(this.getTransform(i))}},{key:"animateFinPos",value:function(){if(this.hasTo()){this.transition_timing=this.getTiming(this.info.to,this.duration);var t=this.transition_timing[0],i=this.transition_timing[1];console.log(i);var e=this;setTimeout(function(){if($("#"+e.css_id).animate(e.convCssPos(e.finPos),{duration:i,progress:function(t,i){e.animateTransform(i),e.isPath()&&$("#"+e.css_id).css("overflow","visible")}}),e.isVideo()&&$("#"+e.css_id+"-video").animate(e.convCssPos(e.finPos),{duration:i}),e.isText()&&(e.finText["font-family"]&&delete e.finText["font-family"],$("#"+e.css_id+"-body").animate(e.finText,{duration:i})),e.isPath()){var t=SwipeParser.clone(e.finPath.path);delete t.stroke,e.path.animate(t,i),e.prevPath.fill!=e.finPath.fill&&setTimeout(function(){e.path.attr({fill:e.finPath.fill})},i)}},t)}}},{key:"animateShow",value:function(t){if(console.log("animateShow"),this.elements&&this.elements.forEach(function(i,e){i.animateShow(t)}),this.hasTo()){var i=this;if($("#"+i.css_id).animate(i.convCssPos(i.finPos),{duration:1e8,step:function(t){"stop"==SwipeUtil.getStatus()&&$(this).stop(0)},easing:"swipe",progress:function(t,e){i.animateTransform(SwipeUtil.getRatio()),i.isPath()&&$("#"+i.css_id).css("overflow","visible")}}),i.isVideo()&&$("#"+i.css_id+"-video").animate(i.convCssPos(i.finPos),{duration:1e8,step:function(t){"stop"==SwipeTouch.getStatus()&&$(this).stop(0)},easing:"swipe"}),i.isPath()){var e=SwipeParser.clone(i.finPath.path);delete e.stroke,i.path.animate(e,1e8,function(t,i,e,s,n){return Math.abs(SwipeUtil.getRatio())},function(){i.prevPath.fill!=i.finPath.fill&&i.path.attr({fill:i.finPath.fill})})}}}},{key:"animateShowBack",value:function(t){if(console.log("animateShowBack"),this.elements&&this.elements.forEach(function(i,e){i.animateShowBack(t)}),this.hasTo()){var i=this;if($("#"+i.css_id).animate(i.convCssPos(i.prevPos),{duration:1e8,step:function(t){"stop"==SwipeTouch.getStatus()&&$(this).stop(0)},easing:"swipe",progress:function(t,e){i.animateTransform(Math.abs(1+SwipeUtil.getRatio())),i.isPath()&&$("#"+i.css_id).css("overflow","visible")}}),this.isPath()){var e=SwipeParser.clone(this.prevPath.path);delete e.stroke,this.path.animate(e,1e8,function(t,i,e,s,n){return Math.abs(SwipeUtil.getRatio())},function(){this.prevPath.fill!=this.finPath.fill&&this.path.attr({fill:this.prevPath.fill})})}}}},{key:"pause",value:function(){this.elements&&this.elements.forEach(function(t,i){t.pause()}),this.isVideo()&&$("#"+this.css_id+"-video")[0].pause()}},{key:"updatePosition",value:function(t,i){var e=Object.assign({},t);if(i.translate){var s=i.translate;e[0]=e[0]+Number(s[0]),e[1]=e[1]+Number(s[1])}if(e[4]=this.getAngle(i.rotate),null!=i.opacity&&(e[5]=Number(i.opacity)),i.scale&&(e[6]=this.getScale(i)),this.isText()){var n=e[2],o=e[3];e[2]=e[2]*e[6][0],e[3]=e[3]*e[6][1],e[0]=e[0]-(e[2]-n)/2,e[1]=e[1]-(e[3]-o)/2}return e}},{key:"getScreenPosition",value:function(t){return[SwipeScreen.virtualX(t[0]),SwipeScreen.virtualY(t[1]),SwipeScreen.virtualX(t[2]),SwipeScreen.virtualY(t[3]),t[4],t[5],t[6]]}},{key:"getScale",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1];return t.scale&&(SwipeParser.is("Array",t.scale)&&2==t.scale.length?i=t.scale:SwipeParser.is("Array",t.scale)&&4==t.scale.length?i=[t.scale[2],t.scale[3]]:SwipeParser.is("Number",t.scale)?i=[t.scale,t.scale]:SwipeParser.is("String",t.scale)&&(i=[Number(t.scale),Number(t.scale)])),i}},{key:"convBasicCssPos",value:function(t){return{left:t[0]+"px",top:t[1]+"px",width:t[2]+"px",height:t[3]+"px",opacity:t[5]}}},{key:"convCssPos",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=this.convBasicCssPos(t),s=[],n=t[4];if(isFinite(n)&&s.push("rotate("+n+"deg)"),!this.isText()&&!this.isPath()&&!i){var o=t[6];SwipeParser.is("Array",o)&&2==o.length&&s.push("scale("+o[0]+","+o[1]+")")}return s.length>0&&(e=this.setTransform(e,s)),e}},{key:"setTransform",value:function(t,i){return i&&i.length>0?SwipeUtil.merge(t,this.getTransform(i)):t}},{key:"getTransform",value:function(t){var i={},e=t.join(" ");return i.transform=e,i["-moz-transform"]=e,i["-webkit-transform"]=e,i["-o-transform"]=e,i["-ms-transform"]=e,i}},{key:"type",value:function(){return this.info.img?"image":this.info.sprite?"sprite":this.info.video?"video":this.info.text?"text":this.info.markdown?"markdown":this.info.path?"path":this.info._pathRoot?"pathRoot":"div"}},{key:"isImage",value:function(){return"image"==this.type()}},{key:"isSprite",value:function(){return"sprite"==this.type()}},{key:"isVideo",value:function(){return"video"==this.type()}},{key:"isText",value:function(){return"text"==this.type()}},{key:"isMarkdown",value:function(){return"markdown"==this.type()}},{key:"isPath",value:function(){return"path"==this.type()}},{key:"isPathRoot",value:function(){return"pathRoot"==this.type()}},{key:"isDiv",value:function(){return"div"==this.type()}},{key:"hasTo",value:function(){return!!this.info.to}},{key:"html",value:function(){this.type()&&(console.log("increase"),o.default.increase(),this.isVideo()&&o.default.increase());var t=this.elements.map(function(t,i){return t.html()}).join("");if(this.isImage())return"<div id='"+this.css_id+"' class='image_box'><div id='"+this.css_id+"_inner' class='element_inner'><img src='"+this.info.img+"' class='image_element image_element_page_"+this.page_id+"' id='"+this.css_id+"_image' __page_id='"+this.page_id+"' __element_id='"+this.element_id+"' __base_id='"+this.css_id+"' >"+t+"</img></div></div>";if(this.isSprite())return"<div id='"+this.css_id+"' class='image_box'><div id='"+this.css_id+"_inner' class='element_inner'><img src='"+this.info.sprite+"' class='image_element image_element_page_"+this.page_id+"' id='"+this.css_id+"_sprite' __page_id='"+this.page_id+"' __element_id='"+this.element_id+"' __base_id='"+this.css_id+"' >"+t+"</img></div></div>";if(this.isText()){var i=this.defaultAttr("element text_element element_page_"+this.page_id);return"<div "+this.getAttrStr(i)+"><div id='"+this.css_id+"_inner' class='element_inner'><div class='text_body' id='"+this.css_id+"-body'><span>"+this.insertBr(this.parseText(this.info.text))+t+"</span></div></div></div>"}if(this.isMarkdown()){var e=this.parseMarkdown(this.info.markdown);return this.md_css=e[1],"<div class='element markdown_element element_page_"+this.page_id+"'  id='"+this.css_id+"' __page_id='"+this.page_id+"' __element_id='"+this.element_id+"' ><div id='"+this.css_id+"_inner' class='element_inner'><div class='markdown_wrap' id='md_"+this.css_id+"'>"+e[0]+t+"</div></div></div>"}if(this.isVideo()){i=this.defaultAttr("element video_element element_page_"+this.page_id+" video_element_"+this.page_id);return"<div "+this.getAttrStr(i)+"><div id='"+this.css_id+"_inner' class='element_inner'><video id='"+this.css_id+"-video'  webkit-playsinline playsinline muted><source type='video/mp4' src='"+this.info.video+"'  /></video>"+t+"</div></div>"}if(this.isPathRoot()){Array.isArray(this.info.elements)?this.info.elements:[this.info.elements];var s=this.swipe_to_path({element:this.info,depth:0});return'<div id="'+this.css_id+'" __page_id="'+this.page_id+'" __element_id="'+this.element_id+'" class="element svg_element element_page_'+this.page_id+'"><div id="'+this.css_id+'_inner" class="element_inner"><svg id="'+this.css_id+'_svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">'+s+"</svg></div></div>"}return this.isPath()?'<div id="'+this.css_id+'" __page_id="'+this.page_id+'" __element_id="'+this.element_id+'" class="element svg_element element_page_'+this.page_id+'"><div id="'+this.css_id+'_inner" class="element_inner"><svg id="'+this.css_id+'_svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"></svg></div></div>':this.isDiv()?"<div class='element boxelement-"+this.page_id+" element_page_"+this.page_id+"' id='"+this.css_id+"' __page_id='"+this.page_id+"' __element_id='"+this.element_id+"' >"+t+"</div>":""}},{key:"swipe_to_path",value:function(t){var i=t.element,e=t.depth,s=this,n=SwipeScreen.getRatio(),o="";if(Array.isArray(i))o=i.map(function(t){return s.swipe_to_path({element:t,scale:n,depth:e+1})});else if(i.elements&&(o=Array.isArray(i.elements)?i.elements.map(function(t){return s.swipe_to_path({element:t,scale:n,depth:e+1})}):s.swipe_to_path({element:i.elements,scale:n,depth:e+1})),i.path)return"<path className='svgPath' d='"+i.path+"' stroke='"+this.strokeColor(i)+"' fill='"+this.fillColor(i)+"' strokeWidth='"+this.pathLine(i)+"' >"+o+"</path>";return 0===e?"<g style='transform: scale("+n+", "+n+")'>"+o+"</g>":o}},{key:"strokeColor",value:function(t){var i=t.strokeColor?t.strokeColor:"black";return this.convRgba2rgb(i)}},{key:"fillColor",value:function(t){var i=t.fillColor?"#0000"===t.fillColor?"none":t.fillColor:"none";return this.convRgba2rgb(i)}},{key:"pathLine",value:function(t){return t.lineWidth?t.lineWidth:1}},{key:"convRgba2rgb",value:function(t){if(t){var i=t.match(/^(#\w{6})(\w{2})$/);if(i)return i[1]}return t}},{key:"defaultAttr",value:function(t){var i={};return i.class=t,i.id=this.css_id,i.__page_id=this.page_id,i.__element_id=this.element_id,i}},{key:"getAttrStr",value:function(t){return Object.keys(t).map(function(i){return i+"='"+t[i]+"'"}).join(" ")}},{key:"resize",value:function(){this.elements&&this.elements.forEach(function(t,i){t.resize()}),this.isImage()&&this.setImageCss(),this.initAllData(),this.isPath()&&(this.prevPath=this.parsePath(),this.finPath=this.parseFinPath()),this.markdown_position()}},{key:"justShow",value:function(){console.log("justShow"),this.elements&&this.elements.forEach(function(t,i){t.justShow()}),this.no_size&&this.setSize(),this.setFinPos()}},{key:"show",value:function(){console.log("show"),this.elements&&this.elements.forEach(function(t,i){t.show()}),this.setPrevPos(),this.animateFinPos(),this.loopProcess()}},{key:"delayShow",value:function(){console.log("delayShow"),this.elements&&this.elements.forEach(function(t,i){t.delayShow()}),this.setPrevPos();var t=this;setTimeout(function(){t.animateFinPos(),t.loopProcess()},SwipeBook.pageInDuration())}},{key:"doLoopProcess",value:function(){console.log("show"),this.elements&&this.elements.forEach(function(t,i){t.doLoopProcess()}),this.loopProcess()}},{key:"getTiming",value:function(t,i){var e=function(t){if(t.timing){var i=t.timing;if(2==i.length&&i[0]>0&&i[1]>=i[0]&&i[1]<=1)return i}return[0,1]}(t);return[e[0],e[1]-e[0],1-e[1]].map(function(t){return t*i})}},{key:"getLoopDuration",value:function(t){var i=t;return this.transition_timing&&0!=this.transition_timing[2]&&(i=this.transition_timing[2]),this.valueFrom(this.info.loop,"duration",i)}},{key:"loopProcess",value:function(){if(this.info.loop){var t=this.getLoopDuration(this.duration);if(this.loop_timing=this.getTiming(this.info.loop,t),"scroll"!=this.play_style&&this.hasTo())if("auto"==this.play_style||"always"==this.play_style){var i=this.duration;this.transition_timing&&(i-=this.transition_timing[2]);this.loop(this,null,i)}else console.log("not animate because "+this.play);else this.loop(this)}}},{key:"moreloop",value:function(t,i,e){i--;var s=this.loop_timing[2];setTimeout(function(){i>0?t.loop(t,i):t.isRepeat&&t.isActive&&(i=e,t.loop(t,i))},s)}},{key:"loop",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;console.log("loop");var s,n=t.info.loop,o=this.loop_timing[0],a=this.loop_timing[1];s=n.count?n.count:1,null==i&&(i=s);var r="#"+t.css_id+"_inner";if(setTimeout(function(){switch(n.style){case"vibrate":var e=t.valueFrom(n,"delta",10),o=t.originalFinPos,h=a/s/4;$(r).animate({left:parseInt(SwipeScreen.virtualX(-e))+"px"},{duration:h,complete:function(){$(r).animate({left:parseInt(SwipeScreen.virtualX(e))+"px"},{duration:2*h,complete:function(){$(r).animate({left:"0px"},{duration:h,complete:function(){--i>0?t.loop(t,i):t.isRepeat&&t.isActive&&(i=s,t.loop(t,i))}})}})}});break;case"shift":var l;o=t.originalFinPos;switch(n.direction){case"n":l={top:SwipeScreen.virtualY(-t.h)+"px"};break;case"e":l={left:parseInt(SwipeScreen.virtualX(t.w))+"px"};break;case"w":l={left:parseInt(SwipeScreen.virtualX(-t.w))+"px"};break;default:l={top:SwipeScreen.virtualY(t.h)+"px"}}h=a/s;t.setPrevPos(),$(r).animate(l,{duration:h,complete:function(){$(r).animate(t.convCssPos(o),{duration:0,complete:function(){t.moreloop(t,i,s)}})}});break;case"blink":console.log("blink");h=a/s/4;$(r).css({opacity:1}),setTimeout(function(){$(r).css({opacity:0}),setTimeout(function(){$(r).css({opacity:1}),setTimeout(function(){t.moreloop(t,i,s)},h)},2*h)},h);break;case"spin":console.log("spin");h=a/s;$(r).rotate({angle:0,animateTo:360,duration:h,callback:function(){t.moreloop(t,i,s)}});break;case"wiggle":console.log("wiggle");var c=t.valueFrom(n,"delta",15);h=a/s/4;$(r).rotate({angle:0,animateTo:c,duration:h,callback:function(){$(r).rotate({angle:c,animateTo:-c,duration:2*h,callback:function(){$(r).rotate({angle:-c,animateTo:0,duration:h,callback:function(){t.moreloop(t,i,s)}})}})}})}},o+e),"sprite"==n.style){console.log("sprite");var h=t.valueFrom(n,"repeat")||t.valueFrom(n,"count");if(t.info.slice)for(var l=t.info.slice[0],c=a/h/l,u=0;u<h;u++)for(var f=function(i){$("#"+t.css_id+"_sprite").delay(c).queue(function(){var e=t.getLoopSpritePos(i);$(this).css(t.getSpriteCss(e)).dequeue()})},p=0;p<l;p++)f(p)}}},{key:"getLoopSpritePos",value:function(t){var i=this.prevPos[2],e=this.prevPos[3];return[-i*t,-e*this.info.slot[1],i*this.info.slice[0],e*this.info.slice[1]]}},{key:"valueFrom",value:function(t,i,e){return t[i]?t[i]:e}},{key:"back",value:function(){console.log("back"),this.elements&&this.elements.forEach(function(t,i){t.back()}),this.setFinPos(),this.animatePrevPos()}},{key:"finShow",value:function(){console.log("finShow"),this.elements&&this.elements.forEach(function(t,i){t.finShow()}),this.setFinPos(),this.loopProcess()}},{key:"setVideoElement",value:function(t){this.videoElement=t}},{key:"inactive",value:function(){this.elements&&this.elements.forEach(function(t,i){t.inactive()}),this.isActive=!1}},{key:"active",value:function(){this.elements&&this.elements.forEach(function(t,i){t.active()}),this.isActive=!0}}]),t}();i.default=a,t.exports=i.default}])});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SwipeMarkdown=t():e.SwipeMarkdown=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}({5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.info=t,this.setMdStyle(),this.info.styles&&(this.md_style=$.extend(!0,this.md_style,this.info.styles)),this.info.shadow&&(this.shadow=this.info.shadow)}return r(e,[{key:"parse",value:function(e,t){var n=this,r=!1,i=[],o=[];return e.map(function(e,t){return"```"===e?(r=!r)?[null,""]:["```+",""]:r?["```",e]:n.getMdSymbol(e)}).forEach(function(e,r){var s=e[0],a=e[1];n.prefixes(s)&&(a=n.prefixes(s)+a),i.push(n.conv_html(a,t,r)),o.push(n.conv_css(s))}),[i.join(""),o]}},{key:"conv_html",value:function(e,t,n){return"<div class='markdown_line' id='"+t+"-"+n+"'>"+e.replace(/\s/g,"&nbsp;")+"</div>"}},{key:"conv_css",value:function(e){var t=this.md_style[e],n=20,r=30,i="",o="left";t&&(t.font&&(t.font.name&&(i=SwipeParser.parseFontName(t.font,!0)),t.font.size&&(r=n=SwipeParser.parseFontSize(t.font,SwipeScreen.swipeheight(),10,!0))),t.alignment&&(o=t.alignment),t.spacing?r+=SwipeParser.parseSize(t.spacing,SwipeScreen.swipeheight(),10):r+=10);var s={position:"relative","font-size":String(SwipeScreen.virtualY(n))+"px","line-height":String(SwipeScreen.virtualY(r))+"px","font-family":i,textAlign:o,color:SwipeParser.parseColor(t,"#000")};return this.shadow&&(s["text-shadow"]=SwipeParser.parseShadow(this.shadow),console.log(s["text-shadow"])),s}},{key:"setMdStyle",value:function(){var e;this.md_style=(i(e={"###":{color:"#800",font:{size:"4%",name:"Helvetica"}},"#":{font:{size:32},spacing:16},"##":{font:{size:28},spacing:14}},"###",{font:{size:24},spacing:12}),i(e,"####",{font:{size:22},spacing:10}),i(e,"*",{font:{size:20},spacing:10}),i(e,"-",{font:{size:20},spacing:5}),i(e,"```",{font:{size:14,name:"Courier"},spacing:0}),i(e,"```+",{font:{size:7,name:"Courier"},spacing:0}),e)}},{key:"getMdStyle",value:function(){return this.md_style}},{key:"getMdSymbol",value:function(e){var t=this.getMdStyle(),n=e.split(" ");return n.length>1&&t[n[0]]?[n.shift(),n.join(" ")]:["*",e]}},{key:"prefixes",value:function(e){var t=this.md_style[e];if(t&&t.prefix)return t.prefix;var n={"-":"• ","```":" "};return e&&n.hasOwnProperty(e)?n[e]:null}}]),e}();t.default=o,e.exports=t.default}})});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SwipeMediaPlayer=t():e.SwipeMediaPlayer=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}({4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.current_page=0,this.current_playing=null,this.media={}}return r(e,null,[{key:"getInstance",value:function(){return this.instance?this.instance:(this.instance=new e,this.instance)}}]),r(e,[{key:"page",value:function(e){return this.current_page=e,this}},{key:"push",value:function(e,t){return this.media[this.current_page]||(this.media[this.current_page]={}),this.media[this.current_page][e]=t,this}},{key:"setCurrent",value:function(){(e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)&&(this.current_page=e);if(this.current_playing!=this.current_page&&this.stop(),this.media[this.current_page]){var e=this.media[this.current_page];Object.keys(e).forEach(function(t){var n=e[t].media,r=e[t]&&e[t].videoDuration?e[t].videoDuration:n.duration,i=(e[t]&&e[t].videoStart?e[t].videoStart:0)+r;n.setCurrentTime(i)})}}},{key:"play",value:function(){(t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)&&(this.current_page=t);var e=this;if(this.current_playing!=this.current_page){if(this.stop(),this.media[this.current_page]){var t=this.media[this.current_page];Object.keys(t).forEach(function(n){var r=t[n],i=r.media,a=0;if(t[n]&&t[n].videoStart&&(a=t[n].videoStart,i.setCurrentTime(a)),r.canPlay?(i.currentTime=0,i.play(),i.addEventListener("ended",function(){e.current_playing=null})):(r.waitPlay=!0,e.media[e.current_page][n]=r),t[n]&&t[n].videoDuration){var u=t[n].videoDuration;setTimeout(function(){i.currentTime+1>Number(a)+Number(u)&&(i.stop(),e.current_playing=null)},1e3*u)}})}this.current_playing=this.current_page}return this}},{key:"playing",value:function(e){e<0&&(e=1+e);var t=this;if(this.media[this.current_page]){var n=this.media[this.current_page];Object.keys(n).forEach(function(r){var i=n[r],a=(i.media,n[r].dom),u=u=n[r]&&n[r].videoStart?n[r].videoStart:0,o=n[r]&&n[r].videoDuration?n[r].videoDuration:1,c=u+e*o;Math.abs(i.currentTime-c)>.05&&(a.currentTime=c,i.currentTime=c,t.media[t.current_page][r]=i)})}}},{key:"load",value:function(){var e=this;Object.keys(this.media).forEach(function(t){var n=e.media[t];Object.keys(n).forEach(function(r){var i=n[r],a=n[r].media;a.addEventListener("loadeddata",function(){e.media[t][r].waitPlay&&a.play(),i.canPlay=!0,e.media[t][r]=i},!1),a.load()})})}},{key:"media",value:function(){return this.media[this.current_page]}},{key:"stop",value:function(){if(null!==this.current_playing&&this.media[this.current_playing]){var e=this.media[this.current_playing];Object.keys(e).forEach(function(t){e[t].media.stop()})}this.current_playing=null}}]),e}();t.default=i,e.exports=t.default}})});
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SwipePage=e():t.SwipePage=e()}(window,function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}();var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return s(t,null,[{key:"increase",value:function(){return void 0===window.counter?window.counter=1:window.counter++,window.counter}},{key:"decrease",value:function(){return void 0===window.counter?window.counter=-1:window.counter--,window.counter}},{key:"getCounter",value:function(){return window.counter}}]),t}();e.default=n,t.exports=e.default},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}();var o=function(){function t(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,null,[{key:"parseColor",value:function(t,e){return t&&t.color?t.color:t&&t.textColor?t.textColor:e}},{key:"transformedPath",value:function(){}},{key:"parseTransform",value:function(){}},{key:"is",value:function(t,e){var i=Object.prototype.toString.call(e).slice(8,-1);return void 0!==e&&null!==e&&i===t}},{key:"inheritProperties",value:function(e,i){var s=t.clone(e),n={};if(i){var o=t.clone(i);for(var a in o){var r=o[a],h=t.clone(r);if(null==s[a])s[a]=h;else if(t.is("Array",s[a])&&t.is("Array",h)){for(var l in n={},h){var c=h[l];t.is("String",c.id)&&(n[c.id]=l)}s[a].forEach(function(e,i){t.is("String",e.id)&&null!=(i=n[e.id])?h[i]=t.inheritProperties(e,h[i]):h.push(e)}),s[a]=h}}}return s}},{key:"localizedStringForKey",value:function(e){var i;if(i={}.strings){var s=i[e];return t.localizedString(s,"ja")}return""}},{key:"localizedString",value:function(t,e){return t[e]?t[e]:t["*"]}},{key:"parseFontSize",value:function(e,i,s,n){var o=n?"size":"fontSize";return e[o]?t.parseSize(e[o],i,s):s}},{key:"parseSize",value:function(e,i,s){return Number.isInteger(e)?e:isFinite(e)?e:t.parsePercent(e,i,s)}},{key:"parsePercent",value:function(t,e,i){var s=t.match(/^([0-9][0-9\\.]*)%$/);return s?Math.floor(s[1])/100*e:i}},{key:"parseFontName",value:function(t,e){if(t){var i=t[e?"name":"fontName"];if("string"===jQuery.type(i))return i;if("array"===jQuery.type(i))return i.join(",")}return"sans-serif, Helvetica"}},{key:"parseShadow",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=t.parseSize((e.offset||[])[0],SwipeScreen.swipeheight(),1)*i;s=SwipeScreen.virtualX(s);var n=t.parseSize((e.offset||[])[1],SwipeScreen.swipewidth(),1)*i;return s+"px "+(n=SwipeScreen.virtualY(n))+"px 3px "+(e.color||"black")}},{key:"clone",value:function(e){var i;if(null==e||"object"!=(void 0===e?"undefined":s(e)))return e;if(e instanceof Date)return(i=new Date).setTime(e.getTime()),i;if(e instanceof Array){i=[];for(var n=0,o=e.length;n<o;n++)i[n]=t.clone(e[n]);return i}if(e instanceof Object){for(var a in i={},e)e.hasOwnProperty(a)&&(i[a]=t.clone(e[a]));return i}throw new Error("Unable to copy obj! Its type isn't supported.")}}]),t}();e.default=o,t.exports=e.default},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=function(t){return t&&t.__esModule?t:{default:t}}(i(0));var a=function(){function t(e,i,s,n,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r="element-"+i+"-"+s;this.info=this.mergeTemplate(e),this.to_info=this.info.to?SwipeUtil.merge(this.info,this.info.to):null,this.css_id=r,this.page_id=i,this.element_id=s,this.play_style=n,this.duration=o,this.parent=a,this.isActive=!1,this.videoStart=0,this.videoDuration=null,this.isRepeat=Boolean(e.repeat),this.x=0,this.y=0,this.angle=this.info.rotate?this.getAngle(this.info.rotate):0,this.to_angle=this.to_info&&this.to_info.rotate?this.getAngle(this.to_info.rotate):0,this.scale=this.getScale(this.info),this.to_scale=this.to_info?this.getScale(this.to_info):[1,1],this.no_size=!1,this.transition_timing=null,this.loop_timing=null,this.elements=[];var h=this;if(this.bc=null,this.info.bc&&(this.bc=this.info.bc),this.info.elements&&!this.isPathRoot()){(Array.isArray(this.info.elements)?this.info.elements:[this.info.elements]).forEach(function(e,a){var r=s+"-"+a;h.elements.push(new t(e,i,r,n,o,h))})}}return n(t,[{key:"mergeTemplate",value:function(t){var e;(t.element||t.template)&&((e=SwipeBook.getTemplateElements()[t.element||t.template])&&(t=SwipeParser.inheritProperties(t,e)));return t}},{key:"insertBr",value:function(t){return t.replace(/\n/g,"<br/>").replace(/\s/g,"&nbsp;")}},{key:"parseText",value:function(t){return"string"==typeof t?t:"object"==(void 0===t?"undefined":s(t))?t.ref?SwipeParser.localizedStringForKey(t.ref):SwipeParser.localizedString(t,"ja"):""}},{key:"parseMarkdown",value:function(t){var e=SwipeBook.getMarkdown();return new SwipeMarkdown(e).parse(t,this.css_id)}},{key:"getElement",value:function(t){if(void 0!==t){var e=t.split("-");return 1==e.length?this.elements[t]:this.elements[e.shift()].getElement(e.join("-"))}return this}},{key:"initData",value:function(t){if(void 0===t)(this.isDiv()||this.isMarkdown())&&(this.parent||$("#"+this.css_id).css("position","absolute")),this.isPath()&&(this.snap=Snap("#"+this.css_id+"_svg"),this.path=this.snap.path()),this.isVideo()&&this.initVideo(),this.setSize(),this.setPosition(),this.setOption(),$("#"+this.css_id).attr("__x",this.x),$("#"+this.css_id).attr("__y",this.y),$("#"+this.css_id).attr("__w",this.w),$("#"+this.css_id).attr("__h",this.h),this.bc&&$("#"+this.css_id).css({"background-color":this.bc}),this.isImage()&&this.setImageCss(),this.initAllData(),this.isPath()&&(this.prevPath=this.parsePath(),this.finPath=this.parseFinPath()),this.setPrevPos(),this.markdown_position();else{var e=t.split("-");1==e.length?this.elements[t].initData():this.elements[e.shift()].initData(e.join("-"))}}},{key:"setImageCss",value:function(){this.w/this.h<$("#"+this.css_id+"_image").attr("__default_width")/$("#"+this.css_id+"_image").attr("__default_height")?($("#"+this.css_id+"_image").css("height","100%"),$("#"+this.css_id+"_image").css("width","auto")):($("#"+this.css_id+"_image").css("height","auth"),$("#"+this.css_id+"_image").css("width","100%")),$("#"+this.css_id+"_image").css("top","50%"),$("#"+this.css_id+"_image").css("left","50%"),$("#"+this.css_id+"_image").css("transform","translate(-50%,-50%)"),$("#"+this.css_id+"_image").css("-webkit-transform","translateY(-50%) translateX(-50%)"),$("#"+this.css_id+"_image").css("-moz-transform","translate(-50%,-50%)")}},{key:"initAllData",value:function(){this.initPosData=[Number(this.x),Number(this.y),Number(this.w),Number(this.h),Number(this.angle),Number(this.opacity),this.scale],this.isText(),this.originalPrevPos=this.updatePosition(this.initPosData,this.info),this.prevPos=this.getScreenPosition(this.originalPrevPos),this.originalFinPos=this.getOriginalFinPos(),this.finPos=this.getScreenPosition(this.originalFinPos),this.isText()&&(this.prevText=this.textLayout(this.info,this.originalPrevPos),this.finText=this.textLayout(this.info,this.originalFinPos))}},{key:"getOriginalFinPos",value:function(){if(this.hasTo()){var t=this.initPosData;return this.info.to.pos&&this.info.to.pos.match(/^M/),this.updatePosition(t,this.to_info)}return this.originalPrevPos}},{key:"path2pos",value:function(t){var e=[0,0],i=t.match(/(\w[0-9\s\.,\-]+)/g);return $.each(i,function(t,i){var s=i.slice(0,1),n=i.slice(1).split(",");"M"==s&&(e=[Number(n[0]),Number(n[1])]),"l"==s&&(e=[Number(e[0])+Number(n[0]),Number(e[1])+Number(n[1])])}),e}},{key:"setOption",value:function(){this.opacity=1,null!=this.info.opacity&&(this.opacity=this.info.opacity),this.info.clip&&!0===this.info.clip&&$("#"+this.css_id).css("overflow","hidden"),this.info._pathRoot&&$("#"+this.css_id).css("overflow","hidden")}},{key:"initVideo",value:function(){this.videoStart=0,this.info.videoStart&&(this.videoStart=this.info.videoStart),this.videoDuration=1,this.info.videoDuration&&(this.videoDuration=this.info.videoDuration)}},{key:"setSize",value:function(){this.info.size?(this.w=this.info.size[0],this.h=this.info.size[1]):(this.info.w?this.w=SwipeParser.parseSize(this.info.w,this.getWidth(),this.getWidth()):this.isImage()?this.w=$("#"+this.css_id).attr("__default_width"):(this.w=this.parentWidth(),this.no_size=!0),this.info.h?this.h=SwipeParser.parseSize(this.info.h,this.getHeight(),this.getHeight()):this.isImage()?this.h=$("#"+this.css_id).attr("__default_height"):(this.h=this.parentHeight(),this.no_size=!0))}},{key:"setPosition",value:function(){this.info.pos?(this.x=this.info.pos[0],this.y=this.info.pos[1]):("right"==this.info.x?this.x=this.parentWidth()-this.w:"left"==this.info.x?this.x=0:"center"==this.info.x?this.x=(this.parentWidth()-this.w)/2:this.info.x&&(this.x=SwipeParser.parseSize(this.info.x,this.parentWidth(),0)),"bottom"==this.info.y?this.y=this.parentHeight()-this.h:"top"==this.info.y?this.y=0:"center"==this.info.y?this.y=(this.parentHeight()-this.h)/2:this.info.y&&(this.y=SwipeParser.parseSize(this.info.y,this.parentHeight(),0)))}},{key:"getAngle",value:function(t){return SwipeParser.is("Array",t)?t[2]:t||0}},{key:"getWidth",value:function(){return this.w?this.w:this.parent?this.parent.getWidth():SwipeScreen.swipewidth()}},{key:"getHeight",value:function(){return this.h?this.h:this.parent?this.parent.getHeight():SwipeScreen.swipeheight()}},{key:"parentWidth",value:function(){var t;return this.parent&&(t=this.parent.getWidth()),t||SwipeScreen.swipewidth()}},{key:"parentHeight",value:function(){var t;return this.parent&&(t=this.parent.getHeight()),t||SwipeScreen.swipeheight()}},{key:"setVideo",value:function(t){$("#"+this.css_id+"-video").css(this.convCssPos(t,!0))}},{key:"getSpritePos",value:function(){var t=this.prevPos[2],e=this.prevPos[3];return[-t*this.info.slot[0],-e*this.info.slot[1],t*this.info.slice[0],e*this.info.slice[1]]}},{key:"getSpriteCss",value:function(t){return{left:t[0],top:t[1],width:t[2],height:t[3]}}},{key:"setSpritePos",value:function(t){$("#"+this.css_id+"_sprite").css(this.getSpriteCss(t))}},{key:"prevShow",value:function(){this.elements&&this.elements.forEach(function(t,e){t.prevShow()}),this.setPrevPos()}},{key:"setPrevPos",value:function(){var t=this;if($("#"+this.css_id).css(this.convCssPos(this.prevPos)),this.isVideo()&&this.setVideo(this.prevPos),this.isSprite()){var e=this.getSpritePos();this.setSpritePos(e)}this.isText()&&($("#"+this.css_id+"-body").css(this.prevText),this.info.textVertical&&$("#"+this.css_id).css(this.textVertical())),this.isPath()&&(this.path.attr(this.prevPath.path),this.path.attr({fill:this.prevPath.fill})),this.isMarkdown()&&this.md_css.forEach(function(e,i){$("#"+t.css_id+"-"+i).css(e)})}},{key:"textLayout",value:function(t,e){var i="center",s="center";if(t.textAlign)switch(t.textAlign){case"left":s="left";break;case"right":s="right";break;case"top":i="top";break;case"bottom":i="bottom"}var n=SwipeParser.parseFontName(t,!1),o=function(t,e){var i=20/480*SwipeScreen.swipeheight(),s=SwipeParser.parseFontSize(t,SwipeScreen.swipeheight(),i,!1);return Math.round(s*Math.abs(e[1]))}(t,e[6]),a=o,r=e[3],h="bottom"==i?r-a:0,l={top:String(SwipeScreen.virtualY(h))+"px",position:"relative","font-size":String(Math.round(o))+"px","line-height":String(Math.round(Math.abs(1.5*o)))+"px","font-family":String(n),textAlign:s,color:this.conv_rgba2rgb(SwipeParser.parseColor(t,"#000"))};return"center"==i&&(l=SwipeUtil.merge(l,{width:"inherit",height:String(SwipeScreen.virtualY(r))+"px",display:"table-cell","vertical-align":"middle"})),l}},{key:"textVertical",value:function(){return{"-webkit-writing-mode":"vertical-rl","-ms-writing-mode":"tb-rl","writing-mode":"vertical-rl"}}},{key:"conv_rgba2rgb",value:function(t){var e;return(e=t.match(/^(#\w{6})(\w{2})$/))?e[1]:t}},{key:"transformPath",value:function(t,e){var i=[],s=[SwipeScreen.getRatio(),SwipeScreen.getRatio()],n=[],o=Math.abs(e[0]),a=Math.abs(e[1]);n=[s[0]*o,s[1]*a];var r=0,h=0;return!e||1==o&&1==a||(r=(1-o)*this.prevPos[2]/2,h=(1-a)*this.prevPos[3]/2,i.push("translate("+String(r)+","+String(h)+")")),i.push("scale("+n.join(",")+")"),i.join(" ")}},{key:"parsePath",value:function(){var t=this.info.lineWidth?this.info.lineWidth:1,e=this.info.strokeColor?this.info.strokeColor:"black",i=this.info.fillColor?"#0000"==this.info.fillColor?"none":this.info.fillColor:"none";return{path:{d:this.info.path,transform:this.transformPath(this.info,this.scale),stroke:this.conv_rgba2rgb(e),strokeWidth:t},fill:this.conv_rgba2rgb(i)}}},{key:"parseFinPath",value:function(){if(!this.hasTo())return this.prevPath;var t=SwipeUtil.merge(this.info,this.info.to),e=t.lineWidth?t.lineWidth:1,i=t.strokeColor?t.strokeColor:"black",s=t.fillColor?"#0000"==t.fillColor?"none":t.fillColor:"none";t.rotate&&[t.rotate[2],this.prevPos[2]/2,this.prevPos[3]/2].join(",");return{path:{d:t.path,transform:this.transformPath(t,this.getScale(t)),stroke:this.conv_rgba2rgb(i),strokeWidth:e},fill:this.conv_rgba2rgb(s)}}},{key:"animatePrevPos",value:function(){if(this.hasTo()){var t=this;if($("#"+t.css_id).animate(t.convCssPos(t.prevPos),{duration:this.duration,progress:function(e,i){t.animateTransform(1-i),t.isPath()&&$("#"+t.css_id).css("overflow","visible")}}),this.isText()&&(t.finText["font-family"]&&delete t.finText["font-family"],$("#"+this.css_id+"-body").animate(this.prevText,{duration:this.duration})),this.isPath()){var e=SwipeParser.clone(this.prevPath.path);delete e.stroke,this.path.animate(e,this.duration),this.prevPath.fill!=this.finPath.fill&&this.path.attr({fill:this.prevPath.fill})}}}},{key:"markdown_position",value:function(){if(this.isMarkdown()){var t=($("#"+this.css_id).height()-$("#md_"+this.css_id).height())/2;$("#md_"+this.css_id).css({top:t,position:"absolute"})}}},{key:"setFinPos",value:function(){if($("#"+this.css_id).css(this.convCssPos(this.finPos)),this.isVideo()&&this.setVideo(this.finPos),this.isText()){var t=this.textLayout(this.info,this.originalFinPos);$("#"+this.css_id+"-body").css(t),this.info.textVertical&&$("#"+this.css_id).css(this.textVertical())}this.isPath()&&(this.path.attr(this.finPath.path),this.path.attr({fill:this.finPath.fill}))}},{key:"animateTransform",value:function(t){var e=[];if(this.angle!=this.to_angle){var i=this.angle*(1-t)+this.to_angle*t;e.push("rotate("+i+"deg)")}else e.push("rotate("+this.angle+"deg)");if(!this.isPath()&&!this.isText())if(this.scale!=this.to_scale){var s=[this.scale[0]*(1-t)+this.to_scale[0]*t,this.scale[1]*(1-t)+this.to_scale[1]*t];e.push("scale("+s[0]+", "+s[1]+")")}else e.push("scale("+this.scale[0]+", "+this.scale[1]+")");$("#"+this.css_id).css(this.getTransform(e))}},{key:"animateFinPos",value:function(){if(this.hasTo()){this.transition_timing=this.getTiming(this.info.to,this.duration);var t=this.transition_timing[0],e=this.transition_timing[1];console.log(e);var i=this;setTimeout(function(){if($("#"+i.css_id).animate(i.convCssPos(i.finPos),{duration:e,progress:function(t,e){i.animateTransform(e),i.isPath()&&$("#"+i.css_id).css("overflow","visible")}}),i.isVideo()&&$("#"+i.css_id+"-video").animate(i.convCssPos(i.finPos),{duration:e}),i.isText()&&(i.finText["font-family"]&&delete i.finText["font-family"],$("#"+i.css_id+"-body").animate(i.finText,{duration:e})),i.isPath()){var t=SwipeParser.clone(i.finPath.path);delete t.stroke,i.path.animate(t,e),i.prevPath.fill!=i.finPath.fill&&setTimeout(function(){i.path.attr({fill:i.finPath.fill})},e)}},t)}}},{key:"animateShow",value:function(t){if(console.log("animateShow"),this.elements&&this.elements.forEach(function(e,i){e.animateShow(t)}),this.hasTo()){var e=this;if($("#"+e.css_id).animate(e.convCssPos(e.finPos),{duration:1e8,step:function(t){"stop"==SwipeUtil.getStatus()&&$(this).stop(0)},easing:"swipe",progress:function(t,i){e.animateTransform(SwipeUtil.getRatio()),e.isPath()&&$("#"+e.css_id).css("overflow","visible")}}),e.isVideo()&&$("#"+e.css_id+"-video").animate(e.convCssPos(e.finPos),{duration:1e8,step:function(t){"stop"==SwipeTouch.getStatus()&&$(this).stop(0)},easing:"swipe"}),e.isPath()){var i=SwipeParser.clone(e.finPath.path);delete i.stroke,e.path.animate(i,1e8,function(t,e,i,s,n){return Math.abs(SwipeUtil.getRatio())},function(){e.prevPath.fill!=e.finPath.fill&&e.path.attr({fill:e.finPath.fill})})}}}},{key:"animateShowBack",value:function(t){if(console.log("animateShowBack"),this.elements&&this.elements.forEach(function(e,i){e.animateShowBack(t)}),this.hasTo()){var e=this;if($("#"+e.css_id).animate(e.convCssPos(e.prevPos),{duration:1e8,step:function(t){"stop"==SwipeTouch.getStatus()&&$(this).stop(0)},easing:"swipe",progress:function(t,i){e.animateTransform(Math.abs(1+SwipeUtil.getRatio())),e.isPath()&&$("#"+e.css_id).css("overflow","visible")}}),this.isPath()){var i=SwipeParser.clone(this.prevPath.path);delete i.stroke,this.path.animate(i,1e8,function(t,e,i,s,n){return Math.abs(SwipeUtil.getRatio())},function(){this.prevPath.fill!=this.finPath.fill&&this.path.attr({fill:this.prevPath.fill})})}}}},{key:"pause",value:function(){this.elements&&this.elements.forEach(function(t,e){t.pause()}),this.isVideo()&&$("#"+this.css_id+"-video")[0].pause()}},{key:"updatePosition",value:function(t,e){var i=Object.assign({},t);if(e.translate){var s=e.translate;i[0]=i[0]+Number(s[0]),i[1]=i[1]+Number(s[1])}if(i[4]=this.getAngle(e.rotate),null!=e.opacity&&(i[5]=Number(e.opacity)),e.scale&&(i[6]=this.getScale(e)),this.isText()){var n=i[2],o=i[3];i[2]=i[2]*i[6][0],i[3]=i[3]*i[6][1],i[0]=i[0]-(i[2]-n)/2,i[1]=i[1]-(i[3]-o)/2}return i}},{key:"getScreenPosition",value:function(t){return[SwipeScreen.virtualX(t[0]),SwipeScreen.virtualY(t[1]),SwipeScreen.virtualX(t[2]),SwipeScreen.virtualY(t[3]),t[4],t[5],t[6]]}},{key:"getScale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1];return t.scale&&(SwipeParser.is("Array",t.scale)&&2==t.scale.length?e=t.scale:SwipeParser.is("Array",t.scale)&&4==t.scale.length?e=[t.scale[2],t.scale[3]]:SwipeParser.is("Number",t.scale)?e=[t.scale,t.scale]:SwipeParser.is("String",t.scale)&&(e=[Number(t.scale),Number(t.scale)])),e}},{key:"convBasicCssPos",value:function(t){return{left:t[0]+"px",top:t[1]+"px",width:t[2]+"px",height:t[3]+"px",opacity:t[5]}}},{key:"convCssPos",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.convBasicCssPos(t),s=[],n=t[4];if(isFinite(n)&&s.push("rotate("+n+"deg)"),!this.isText()&&!this.isPath()&&!e){var o=t[6];SwipeParser.is("Array",o)&&2==o.length&&s.push("scale("+o[0]+","+o[1]+")")}return s.length>0&&(i=this.setTransform(i,s)),i}},{key:"setTransform",value:function(t,e){return e&&e.length>0?SwipeUtil.merge(t,this.getTransform(e)):t}},{key:"getTransform",value:function(t){var e={},i=t.join(" ");return e.transform=i,e["-moz-transform"]=i,e["-webkit-transform"]=i,e["-o-transform"]=i,e["-ms-transform"]=i,e}},{key:"type",value:function(){return this.info.img?"image":this.info.sprite?"sprite":this.info.video?"video":this.info.text?"text":this.info.markdown?"markdown":this.info.path?"path":this.info._pathRoot?"pathRoot":"div"}},{key:"isImage",value:function(){return"image"==this.type()}},{key:"isSprite",value:function(){return"sprite"==this.type()}},{key:"isVideo",value:function(){return"video"==this.type()}},{key:"isText",value:function(){return"text"==this.type()}},{key:"isMarkdown",value:function(){return"markdown"==this.type()}},{key:"isPath",value:function(){return"path"==this.type()}},{key:"isPathRoot",value:function(){return"pathRoot"==this.type()}},{key:"isDiv",value:function(){return"div"==this.type()}},{key:"hasTo",value:function(){return!!this.info.to}},{key:"html",value:function(){this.type()&&(console.log("increase"),o.default.increase(),this.isVideo()&&o.default.increase());var t=this.elements.map(function(t,e){return t.html()}).join("");if(this.isImage())return"<div id='"+this.css_id+"' class='image_box'><div id='"+this.css_id+"_inner' class='element_inner'><img src='"+this.info.img+"' class='image_element image_element_page_"+this.page_id+"' id='"+this.css_id+"_image' __page_id='"+this.page_id+"' __element_id='"+this.element_id+"' __base_id='"+this.css_id+"' >"+t+"</img></div></div>";if(this.isSprite())return"<div id='"+this.css_id+"' class='image_box'><div id='"+this.css_id+"_inner' class='element_inner'><img src='"+this.info.sprite+"' class='image_element image_element_page_"+this.page_id+"' id='"+this.css_id+"_sprite' __page_id='"+this.page_id+"' __element_id='"+this.element_id+"' __base_id='"+this.css_id+"' >"+t+"</img></div></div>";if(this.isText()){var e=this.defaultAttr("element text_element element_page_"+this.page_id);return"<div "+this.getAttrStr(e)+"><div id='"+this.css_id+"_inner' class='element_inner'><div class='text_body' id='"+this.css_id+"-body'><span>"+this.insertBr(this.parseText(this.info.text))+t+"</span></div></div></div>"}if(this.isMarkdown()){var i=this.parseMarkdown(this.info.markdown);return this.md_css=i[1],"<div class='element markdown_element element_page_"+this.page_id+"'  id='"+this.css_id+"' __page_id='"+this.page_id+"' __element_id='"+this.element_id+"' ><div id='"+this.css_id+"_inner' class='element_inner'><div class='markdown_wrap' id='md_"+this.css_id+"'>"+i[0]+t+"</div></div></div>"}if(this.isVideo()){e=this.defaultAttr("element video_element element_page_"+this.page_id+" video_element_"+this.page_id);return"<div "+this.getAttrStr(e)+"><div id='"+this.css_id+"_inner' class='element_inner'><video id='"+this.css_id+"-video'  webkit-playsinline playsinline muted><source type='video/mp4' src='"+this.info.video+"'  /></video>"+t+"</div></div>"}if(this.isPathRoot()){Array.isArray(this.info.elements)?this.info.elements:[this.info.elements];var s=this.swipe_to_path({element:this.info,depth:0});return'<div id="'+this.css_id+'" __page_id="'+this.page_id+'" __element_id="'+this.element_id+'" class="element svg_element element_page_'+this.page_id+'"><div id="'+this.css_id+'_inner" class="element_inner"><svg id="'+this.css_id+'_svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">'+s+"</svg></div></div>"}return this.isPath()?'<div id="'+this.css_id+'" __page_id="'+this.page_id+'" __element_id="'+this.element_id+'" class="element svg_element element_page_'+this.page_id+'"><div id="'+this.css_id+'_inner" class="element_inner"><svg id="'+this.css_id+'_svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"></svg></div></div>':this.isDiv()?"<div class='element boxelement-"+this.page_id+" element_page_"+this.page_id+"' id='"+this.css_id+"' __page_id='"+this.page_id+"' __element_id='"+this.element_id+"' >"+t+"</div>":""}},{key:"swipe_to_path",value:function(t){var e=t.element,i=t.depth,s=this,n=SwipeScreen.getRatio(),o="";if(Array.isArray(e))o=e.map(function(t){return s.swipe_to_path({element:t,scale:n,depth:i+1})});else if(e.elements&&(o=Array.isArray(e.elements)?e.elements.map(function(t){return s.swipe_to_path({element:t,scale:n,depth:i+1})}):s.swipe_to_path({element:e.elements,scale:n,depth:i+1})),e.path)return"<path className='svgPath' d='"+e.path+"' stroke='"+this.strokeColor(e)+"' fill='"+this.fillColor(e)+"' strokeWidth='"+this.pathLine(e)+"' >"+o+"</path>";return 0===i?"<g style='transform: scale("+n+", "+n+")'>"+o+"</g>":o}},{key:"strokeColor",value:function(t){var e=t.strokeColor?t.strokeColor:"black";return this.convRgba2rgb(e)}},{key:"fillColor",value:function(t){var e=t.fillColor?"#0000"===t.fillColor?"none":t.fillColor:"none";return this.convRgba2rgb(e)}},{key:"pathLine",value:function(t){return t.lineWidth?t.lineWidth:1}},{key:"convRgba2rgb",value:function(t){if(t){var e=t.match(/^(#\w{6})(\w{2})$/);if(e)return e[1]}return t}},{key:"defaultAttr",value:function(t){var e={};return e.class=t,e.id=this.css_id,e.__page_id=this.page_id,e.__element_id=this.element_id,e}},{key:"getAttrStr",value:function(t){return Object.keys(t).map(function(e){return e+"='"+t[e]+"'"}).join(" ")}},{key:"resize",value:function(){this.elements&&this.elements.forEach(function(t,e){t.resize()}),this.isImage()&&this.setImageCss(),this.initAllData(),this.isPath()&&(this.prevPath=this.parsePath(),this.finPath=this.parseFinPath()),this.markdown_position()}},{key:"justShow",value:function(){console.log("justShow"),this.elements&&this.elements.forEach(function(t,e){t.justShow()}),this.no_size&&this.setSize(),this.setFinPos()}},{key:"show",value:function(){console.log("show"),this.elements&&this.elements.forEach(function(t,e){t.show()}),this.setPrevPos(),this.animateFinPos(),this.loopProcess()}},{key:"delayShow",value:function(){console.log("delayShow"),this.elements&&this.elements.forEach(function(t,e){t.delayShow()}),this.setPrevPos();var t=this;setTimeout(function(){t.animateFinPos(),t.loopProcess()},SwipeBook.pageInDuration())}},{key:"doLoopProcess",value:function(){console.log("show"),this.elements&&this.elements.forEach(function(t,e){t.doLoopProcess()}),this.loopProcess()}},{key:"getTiming",value:function(t,e){var i=function(t){if(t.timing){var e=t.timing;if(2==e.length&&e[0]>0&&e[1]>=e[0]&&e[1]<=1)return e}return[0,1]}(t);return[i[0],i[1]-i[0],1-i[1]].map(function(t){return t*e})}},{key:"getLoopDuration",value:function(t){var e=t;return this.transition_timing&&0!=this.transition_timing[2]&&(e=this.transition_timing[2]),this.valueFrom(this.info.loop,"duration",e)}},{key:"loopProcess",value:function(){if(this.info.loop){var t=this.getLoopDuration(this.duration);if(this.loop_timing=this.getTiming(this.info.loop,t),"scroll"!=this.play_style&&this.hasTo())if("auto"==this.play_style||"always"==this.play_style){var e=this.duration;this.transition_timing&&(e-=this.transition_timing[2]);this.loop(this,null,e)}else console.log("not animate because "+this.play);else this.loop(this)}}},{key:"moreloop",value:function(t,e,i){e--;var s=this.loop_timing[2];setTimeout(function(){e>0?t.loop(t,e):t.isRepeat&&t.isActive&&(e=i,t.loop(t,e))},s)}},{key:"loop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;console.log("loop");var s,n=t.info.loop,o=this.loop_timing[0],a=this.loop_timing[1];s=n.count?n.count:1,null==e&&(e=s);var r="#"+t.css_id+"_inner";if(setTimeout(function(){switch(n.style){case"vibrate":var i=t.valueFrom(n,"delta",10),o=t.originalFinPos,h=a/s/4;$(r).animate({left:parseInt(SwipeScreen.virtualX(-i))+"px"},{duration:h,complete:function(){$(r).animate({left:parseInt(SwipeScreen.virtualX(i))+"px"},{duration:2*h,complete:function(){$(r).animate({left:"0px"},{duration:h,complete:function(){--e>0?t.loop(t,e):t.isRepeat&&t.isActive&&(e=s,t.loop(t,e))}})}})}});break;case"shift":var l;o=t.originalFinPos;switch(n.direction){case"n":l={top:SwipeScreen.virtualY(-t.h)+"px"};break;case"e":l={left:parseInt(SwipeScreen.virtualX(t.w))+"px"};break;case"w":l={left:parseInt(SwipeScreen.virtualX(-t.w))+"px"};break;default:l={top:SwipeScreen.virtualY(t.h)+"px"}}h=a/s;t.setPrevPos(),$(r).animate(l,{duration:h,complete:function(){$(r).animate(t.convCssPos(o),{duration:0,complete:function(){t.moreloop(t,e,s)}})}});break;case"blink":console.log("blink");h=a/s/4;$(r).css({opacity:1}),setTimeout(function(){$(r).css({opacity:0}),setTimeout(function(){$(r).css({opacity:1}),setTimeout(function(){t.moreloop(t,e,s)},h)},2*h)},h);break;case"spin":console.log("spin");h=a/s;$(r).rotate({angle:0,animateTo:360,duration:h,callback:function(){t.moreloop(t,e,s)}});break;case"wiggle":console.log("wiggle");var c=t.valueFrom(n,"delta",15);h=a/s/4;$(r).rotate({angle:0,animateTo:c,duration:h,callback:function(){$(r).rotate({angle:c,animateTo:-c,duration:2*h,callback:function(){$(r).rotate({angle:-c,animateTo:0,duration:h,callback:function(){t.moreloop(t,e,s)}})}})}})}},o+i),"sprite"==n.style){console.log("sprite");var h=t.valueFrom(n,"repeat")||t.valueFrom(n,"count");if(t.info.slice)for(var l=t.info.slice[0],c=a/h/l,u=0;u<h;u++)for(var f=function(e){$("#"+t.css_id+"_sprite").delay(c).queue(function(){var i=t.getLoopSpritePos(e);$(this).css(t.getSpriteCss(i)).dequeue()})},p=0;p<l;p++)f(p)}}},{key:"getLoopSpritePos",value:function(t){var e=this.prevPos[2],i=this.prevPos[3];return[-e*t,-i*this.info.slot[1],e*this.info.slice[0],i*this.info.slice[1]]}},{key:"valueFrom",value:function(t,e,i){return t[e]?t[e]:i}},{key:"back",value:function(){console.log("back"),this.elements&&this.elements.forEach(function(t,e){t.back()}),this.setFinPos(),this.animatePrevPos()}},{key:"finShow",value:function(){console.log("finShow"),this.elements&&this.elements.forEach(function(t,e){t.finShow()}),this.setFinPos(),this.loopProcess()}},{key:"setVideoElement",value:function(t){this.videoElement=t}},{key:"inactive",value:function(){this.elements&&this.elements.forEach(function(t,e){t.inactive()}),this.isActive=!1}},{key:"active",value:function(){this.elements&&this.elements.forEach(function(t,e){t.active()}),this.isActive=!0}}]),t}();e.default=a,t.exports=e.default},,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=a(i(1)),o=a(i(2));function a(t){return t&&t.__esModule?t:{default:t}}var r=function(){function t(e,i,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i&&(e=n.default.inheritProperties(e,i)),this.page=e,this.scene=i,this.index=s,this.elements=[],this.duration=this.page.duration?1e3*this.page.duration:200,this.bc=this.page.bc||"#ffffff",this.play_style=this.page.play||"auto",this.transition=this.page.transition||("scroll"==this.play_style?"replace":"scroll")}return s(t,[{key:"loadElement",value:function(){var t=this;this.page.elements&&this.page.elements.forEach(function(e,i){t.elements.push(new o.default(e,t.index,i,t.play_style,t.duration))})}},{key:"elementLoad",value:function(t){var e=[],i=this;return e.push(t),t.elements&&t.elements.forEach(function(s,n){i.elementLoad(s).forEach(function(i,s){var n=Object.assign({},t);delete n.elements,e.push($.extend(!0,n,i))})}),e}},{key:"getHtml",value:function(){var t=[];return this.elements.forEach(function(e,i){t.push(e.html())}),"<div id='page_"+this.index+"' class='page' __page_id='"+this.index+"'>"+t.join("")+"</div>"}},{key:"getBc",value:function(){return this.bc}},{key:"getTransition",value:function(){return this.transition}},{key:"getPlayStyle",value:function(){return this.play_style}},{key:"initElement",value:function(t){var e=t.split("-");1==e.length?this.elements[t].initData():this.elements[e.shift()].initData(e.join("-"))}},{key:"getElement",value:function(t){var e=t.split("-");return 1==e.length?this.elements[t].getElement():this.elements[e.shift()].getElement(e.join("-"))}},{key:"resize",value:function(){this.elements.forEach(function(t,e){t.resize()})}},{key:"justShow",value:function(){this.elements.forEach(function(t,e){t.justShow()})}},{key:"show",value:function(){var t=this;this.elements.forEach(function(t,e){t.show()}),setTimeout(function(){t.speech(t)},this.duration)}},{key:"animateShow",value:function(){this.elements.forEach(function(t,e){t.animateShow()})}},{key:"animateShowBack",value:function(){this.elements.forEach(function(t,e){t.animateShowBack()})}},{key:"delayShow",value:function(){var t=this;this.elements.forEach(function(t,e){t.delayShow()}),setTimeout(function(){t.speech(t)},this.duration)}},{key:"back",value:function(){var t=this;this.elements.forEach(function(t,e){t.back()}),setTimeout(function(){t.speech(t)},this.duration)}},{key:"finShow",value:function(){this.elements.forEach(function(t,e){t.finShow()})}},{key:"prevShow",value:function(){this.elements.forEach(function(t,e){t.prevShow()})}},{key:"pause",value:function(){this.elements.forEach(function(t,e){t.pause()})}},{key:"doLoopProcess",value:function(){this.elements.forEach(function(t,e){t.doLoopProcess()})}},{key:"getScene",value:function(){return this.scene}},{key:"speech",value:function(t){var e=window.navigator.userAgent.toLowerCase();-1==e.indexOf("chrome")&&-1==e.indexOf("safari")||t.page.speech&&speechSynthesis.speak(new SpeechSynthesisUtterance(t.page.speech.text))}},{key:"active",value:function(){this.elements.forEach(function(t,e){t.active()})}},{key:"inactive",value:function(){this.elements.forEach(function(t,e){t.inactive()})}}]),t}();e.default=r,t.exports=e.default}])});
!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.SwipeParser=r():e.SwipeParser=r()}(window,function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=1)}([,function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();var i=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,null,[{key:"parseColor",value:function(e,r){return e&&e.color?e.color:e&&e.textColor?e.textColor:r}},{key:"transformedPath",value:function(){}},{key:"parseTransform",value:function(){}},{key:"is",value:function(e,r){var t=Object.prototype.toString.call(r).slice(8,-1);return void 0!==r&&null!==r&&t===e}},{key:"inheritProperties",value:function(r,t){var n=e.clone(r),o={};if(t){var i=e.clone(t);for(var u in i){var a=i[u],f=e.clone(a);if(null==n[u])n[u]=f;else if(e.is("Array",n[u])&&e.is("Array",f)){for(var l in o={},f){var c=f[l];e.is("String",c.id)&&(o[c.id]=l)}n[u].forEach(function(r,t){e.is("String",r.id)&&null!=(t=o[r.id])?f[t]=e.inheritProperties(r,f[t]):f.push(r)}),n[u]=f}}}return n}},{key:"localizedStringForKey",value:function(r){var t;if(t={}.strings){var n=t[r];return e.localizedString(n,"ja")}return""}},{key:"localizedString",value:function(e,r){return e[r]?e[r]:e["*"]}},{key:"parseFontSize",value:function(r,t,n,o){var i=o?"size":"fontSize";return r[i]?e.parseSize(r[i],t,n):n}},{key:"parseSize",value:function(r,t,n){return Number.isInteger(r)?r:isFinite(r)?r:e.parsePercent(r,t,n)}},{key:"parsePercent",value:function(e,r,t){var n=e.match(/^([0-9][0-9\\.]*)%$/);return n?Math.floor(n[1])/100*r:t}},{key:"parseFontName",value:function(e,r){if(e){var t=e[r?"name":"fontName"];if("string"===jQuery.type(t))return t;if("array"===jQuery.type(t))return t.join(",")}return"sans-serif, Helvetica"}},{key:"parseShadow",value:function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.parseSize((r.offset||[])[0],SwipeScreen.swipeheight(),1)*t;n=SwipeScreen.virtualX(n);var o=e.parseSize((r.offset||[])[1],SwipeScreen.swipewidth(),1)*t;return n+"px "+(o=SwipeScreen.virtualY(o))+"px 3px "+(r.color||"black")}},{key:"clone",value:function(r){var t;if(null==r||"object"!=(void 0===r?"undefined":n(r)))return r;if(r instanceof Date)return(t=new Date).setTime(r.getTime()),t;if(r instanceof Array){t=[];for(var o=0,i=r.length;o<i;o++)t[o]=e.clone(r[o]);return t}if(r instanceof Object){for(var u in t={},r)r.hasOwnProperty(u)&&(t[u]=e.clone(r[u]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")}}]),e}();r.default=i,e.exports=r.default}])});
!function(e,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.SwipeScreen=i():e.SwipeScreen=i()}(window,function(){return function(e){var i={};function n(t){if(i[t])return i[t].exports;var w=i[t]={i:t,l:!1,exports:{}};return e[t].call(w.exports,w,w.exports,n),w.l=!0,w.exports}return n.m=e,n.c=i,n.d=function(e,i,t){n.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,i){if(1&i&&(e=n(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var w in e)n.d(t,w,function(i){return e[i]}.bind(null,w));return t},n.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(i,"a",i),i},n.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},n.p="",n(n.s=3)}({3:function(e,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=function(){function e(e,i){for(var n=0;n<i.length;n++){var t=i[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(i,n,t){return n&&e(i.prototype,n),t&&e(i,t),i}}();var w=function(){function e(){!function(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this,e)}return t(e,null,[{key:"getSize",value:function(){return window.swipe_screen_size?window.swipe_screen_size[1]:100}},{key:"setSize",value:function(e){window.swipe_screen_size=[e,e]}},{key:"setSizes",value:function(e,i){window.swipe_screen_size=[e,i]}},{key:"init",value:function(i,n){window.swipe_screen_width=i,window.swipe_screen_height=n,0==window.swipe_screen_width&&(window.swipe_screen_width=window.swipe_screen_height*$(window).width()/$(window).height()),0==window.swipe_screen_height&&(window.swipe_screen_height=window.swipe_screen_width*$(window).height()/$(window).width()),e.setOriginalSize(),e.setVirtualSize()}},{key:"setOriginalSize",value:function(){window.swipe_screen_window_width=$(window).width(),window.swipe_screen_window_height=$(window).height()}},{key:"setVirtualSize",value:function(){var e=window.swipe_screen_size||[100,100],i=window.swipe_screen_window_width*e[0]/(window.swipe_screen_window_height*e[1]),n=window.swipe_screen_width/window.swipe_screen_height;window.swipe_screen_ratio=1,i/n>=1?(window.swipe_screen_virtual_height=$(window).height()*e[1]/100,window.swipe_screen_virtual_width=window.swipe_screen_width/window.swipe_screen_height*window.swipe_screen_virtual_height):(window.swipe_screen_virtual_width=$(window).width()*e[0]/100,window.swipe_screen_virtual_height=window.swipe_screen_height/window.swipe_screen_width*window.swipe_screen_virtual_width),window.swipe_screen_ratio=window.swipe_screen_virtual_width/window.swipe_screen_width}},{key:"getRatio",value:function(){return window.swipe_screen_ratio}},{key:"swipewidth",value:function(){return window.swipe_screen_width}},{key:"swipeheight",value:function(){return window.swipe_screen_height}},{key:"virtualwidth",value:function(){return window.swipe_screen_virtual_width}},{key:"virtualheight",value:function(){return window.swipe_screen_virtual_height}},{key:"refresh",value:function(){e.setOriginalSize(),e.setVirtualSize()}},{key:"virtualX",value:function(e){return void 0==e?window.swipe_screen_virtual_width:window.swipe_screen_width?e/window.swipe_screen_width*window.swipe_screen_virtual_width:e}},{key:"virtualY",value:function(e){return void 0==e?window.swipe_screen_virtual_height:window.swipe_screen_height?e/window.swipe_screen_height*window.swipe_screen_virtual_height:e}}]),e}();i.default=w,e.exports=i.default}})});
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SwipeTouch=e():t.SwipeTouch=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}({8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,null,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.startY=0,this.currentY=0,this.diff=0,this.ratio=0,this.options=e,this.status="stop",this.paging=e.paging?e.paging:"vertical",console.log(this.paging);e.dom?e.dom:window;var n="onwheel"in document?"wheel":"onmousewheel"in document?"mousewheel":"DOMMouseScroll",i=this;$(window).on("scrollstart",function(e){var n=void 0;"rightToLeft"==i.paging||"leftToRight"==i.paging?n=e.originalEvent.clientX?e.originalEvent.clientX:event.changedTouches[0].pageX:"vertical"==i.paging&&(n=e.originalEvent.clientY?e.originalEvent.clientY:event.changedTouches[0].pageY),i.currentY=n,i.startY=n,t.start_event(e)}).on(n,function(e){e.preventDefault();var n=void 0;"rightToLeft"==i.paging||"leftToRight"==i.paging?n=e.originalEvent.deltaX?-e.originalEvent.deltaX:e.originalEvent.wheelDelta?e.originalEvent.wheelDelta:-e.originalEvent.detail:"vertical"==i.paging&&(n=e.originalEvent.deltaY?-e.originalEvent.deltaY:e.originalEvent.wheelDelta?e.originalEvent.wheelDelta:-e.originalEvent.detail),n||0===n?i.currentY=i.currentY-n:"rightToLeft"==i.paging||"leftToRight"==i.paging?i.currentY=event.changedTouches[0].pageX:"vertical"==i.paging&&(i.currentY=event.changedTouches[0].pageY),i.diff=i.currentY-i.startY,"rightToLeft"==i.paging?i.ratio=i.diff/$(window).innerWidth():"leftToRight"==i.paging?i.ratio=-i.diff/$(window).innerWidth():"vertical"==i.paging&&(i.ratio=i.diff/$(window).innerHeight()),i.ratio>1&&(i.ratio=1),i.ratio<-1&&(i.ratio=-1),t.scroll_event_handler(e,i.ratio)}).on("scrollstop",function(e){console.log("scrollstop"),t.stop_event(e)}).on("touchstart",function(e){var n;"rightToLeft"==i.paging||"leftToRight"==i.paging?n=e.originalEvent.clientX?e.originalEvent.clientX:event.changedTouches[0].pageX:"vertical"==i.paging&&(n=e.originalEvent.clientY?e.originalEvent.clientY:event.changedTouches[0].pageY),i.startY=n,t.start_event(e)}).on("touchmove.noScroll",function(e){e.preventDefault();var n=void 0;"rightToLeft"==i.paging||"leftToRight"==i.paging?n=e.originalEvent&&e.originalEvent.pageX?e.originalEvent.pageX:event.changedTouches[0].pageX:"vertical"==i.paging&&(n=e.originalEvent&&e.originalEvent.pageY?e.originalEvent.pageY:event.changedTouches[0].pageY),i.diff=i.startY-n,"rightToLeft"==i.paging?i.ratio=i.diff/$(window).innerWidth():"leftToRight"==i.paging?i.ratio=-i.diff/$(window).innerWidth():"vertical"==i.paging&&(i.ratio=i.diff/$(window).innerHeight()),t.scroll_event_handler(e,i.ratio)}).on("touchend",function(e){t.stop_event(e)})}},{key:"scroll_event_handler",value:function(t,e){console.log("scroll"),this.status="scroll",this.options.scroll_callback&&this.options.scroll_callback(t,e)}},{key:"stop_event",value:function(t){console.log("stop"),this.status="stop",this.options.stop_callback&&this.options.stop_callback(t,this.ratio)}},{key:"getRatio",value:function(){return this.ratio}},{key:"start_event",value:function(){this.ratio=0,console.log("start"),this.status="start",this.options.start_callback&&this.options.start_callback(event,this.ratio)}},{key:"getStatus",value:function(){return this.status}}]),t}();e.default=o,t.exports=e.default}})});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SwipeUtil=t():e.SwipeUtil=t()}(window,function(){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=9)}({9:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"getParameterByName",value:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}},{key:"reloadSwipe",value:function(e,t,o){location.hash;var n=new SwipeBook(e,0,t,o);this.swipe_book=n}},{key:"initSwipe",value:function(t,o,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];$(document.body).css({margin:0,padding:0,"background-color":"#fff","font-size":"26px"}),$("div").css({margin:0,padding:0,"background-color":"#fff","font-size":"26px"});var i=0;location.hash&&(i=Number(location.hash.substr(1)));var r=new SwipeBook(t,i,o,n);if(this.swipe_book=r,$(o).on("click",function(){r.next()}),$(window).on("hashchange",function(){var e=Number(location.hash.substr(1));"#"+r.getStep()!=location.hash&&(r.getStep()>e?r.back():r.next())}),$(window).resize(function(){clearTimeout(window.resizedFinished),window.resizedFinished=setTimeout(function(){r.resize()},250)}),"1"===e.getParameterByName("autoplay")){var a=e.getParameterByName("autoplayDuration")||1e3;console.log("duatio "+a);!function t(){setTimeout(function(){r.next();var o=Number(location.hash.substr(1));console.log(r.getPageSize()),r.getPageSize()>o+1?t():"1"===e.getParameterByName("autoloop")&&setTimeout(function(){r.show(0),t()},a)},a)}()}}},{key:"getSwipeBook",value:function(){return this.swipe_book}},{key:"merge",value:function(e,t){for(var o={},n=Object.keys(e),i=0;i<n.length;i++)o[n[i]]=e[n[i]];for(n=Object.keys(t),i=0;i<n.length;i++)o[n[i]]=t[n[i]];return o}},{key:"initTouchSwipe",value:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#swipe",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#swipe_back";$(document.body).css({margin:0,padding:0,"background-color":"#fff","font-size":"26px"}),$("div").css({margin:0,padding:0,"background-color":"#fff","font-size":"26px"}),$(n).css({"touch-action":"none"});var i=t.paging||"vertical",r=new SwipeBook(t,0,o,n);this.swipe_book=r,this.ratio=null,$(window).resize(function(){clearTimeout(window.resizedFinished),window.resizedFinished=setTimeout(function(){r.resize()},250)}),$.extend($.easing,{swipe:function(t,o,n,i,r){return Math.abs(e.getRatio())},swipeangle:function(t,o,n,i,r){return n+Math.abs(e.getRatio())*i}}),SwipeTouch.init({start_callback:e.start_event,scroll_callback:e.scroll_event_handler,stop_callback:e.stop_event,paging:i})}},{key:"getRatio",value:function(){return this.ratio}},{key:"setRatio",value:function(e){this.ratio=e}},{key:"getStatus",value:function(){return this.status}},{key:"setStatus",value:function(e){this.status=e}},{key:"start_event",value:function(t,o){e.getSwipeBook();"stopping"==e.getStatus()&&e.stop(),this.ratio=0,console.log("start ratio "+String(o)),e.setStatus("start")}},{key:"scroll_event_handler",value:function(t,o){var n="start";e.setRatio(o),o>0&&(n="forward"),o<0&&(n="back");var i=e.getSwipeBook();n!=e.getStatus()&&("forward"==n&&("back"==e.getStatus()&&i.prevHide(),i.nextStart(o)),"back"==n&&("forward"==e.getStatus()&&i.nextHide(),i.prevStart(o)),e.setStatus(n)),i.view(o)}},{key:"stop_event",value:function(t,o){e.setRatio(o),o>0?(e.setStatus("stopping"),e.go_ratio(.03)):(e.setStatus("stopping"),e.go_ratio(-.03))}},{key:"stop",value:function(){var t=e.getSwipeBook();e.setStatus("stop"),this.ratio>0?(e.setRatio(1),t.nextEnd()):this.ratio<0&&(e.setRatio(-1),t.prevEnd())}},{key:"go_ratio",value:function(t){if("stopping"==e.getStatus()){this.ratio=this.ratio+t;var o=e.getSwipeBook();if(Math.abs(this.ratio)>1)e.stop();else{o=e.getSwipeBook();e.setRatio(this.ratio),o.view(this.ratio),setTimeout(function(){e.go_ratio(t)},2)}}}},{key:"replaceObject",value:function(t,o,i){return Array.isArray(t)?t=t.map(function(t){return e.replaceObject(t,o,i)}):"object"===(void 0===t?"undefined":n(t))&&null!==t?(Object.keys(t).map(function(n){t[n]=e.replaceObject(t[n],o,i)}),t):t===o?i:t}}]),e}();t.default=r,e.exports=t.default}})});